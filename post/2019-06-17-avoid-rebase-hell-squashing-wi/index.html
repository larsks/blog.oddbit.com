<!doctype html><html lang=en><head><title>Avoid rebase hell: squashing without rebasing :: blog.oddbit.com</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="You&rsquo;re working on a pull request. You&rsquo;ve been working on a pull request for a while, and due to lack of sleep or inebriation you&rsquo;ve been merging changes into your feature branch rather than rebasing. You now have a pull request that looks like this (I&rsquo;ve marked merge commits with the text [merge]):
7e181479 Adds methods for widget sales 0487162 [merge] Merge remote-tracking branch 'origin/master' into my_feature 76ee81c [merge] Merge branch 'my_feature' of https://github.com/my_user_name/widgets into my_feature 981aab4 Adds api for the widget service. b048836 Includes fixes suggested by reviewer. 3dd0c22 adds changes requested by reviewer 5891db2 [merge] fixing merge conflicts 2e226e4 fixes suggestions given by the reviewer da1e85c Adds gadget related API spec c555cc1 Adds doodad related API spec e5beb3e Adds api for update and delete of widgets c43bade Adds api for creating widgets deaa962 Adds all get methods for listing widgets 9de79ab Adds api for showing a widget and simple data model 8288ab1 Adds api framework for widget service You know that&rsquo;s a mess, so you try to fix it by running git rebase -i master and squashing everything together&mldr;and you find yourself stuck in an endless maze of merge conflicts. There has to be a better way!
"><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://blog.oddbit.com/post/2019-06-17-avoid-rebase-hell-squashing-wi/><script async src="https://www.googletagmanager.com/gtag/js?id=G-G1FYT93ENG"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-G1FYT93ENG")}</script><link rel=stylesheet href=https://blog.oddbit.com/css/buttons.min.86f6b4c106b6c6eb690ae5203d36b442c1f66f718ff4e8164fa86cf6c61ad641.css><link rel=stylesheet href=https://blog.oddbit.com/css/code.min.d529ea4b2fb8d34328d7d31afc5466d5f7bc2f0bc9abdd98b69385335d7baee4.css><link rel=stylesheet href=https://blog.oddbit.com/css/fonts.min.5bb7ed13e1d00d8ff39ea84af26737007eb5051b157b86fc24487c94f3dc8bbe.css><link rel=stylesheet href=https://blog.oddbit.com/css/footer.min.eb8dfc2c6a7eafa36cd3ba92d63e69e849e2200e0002a228d137f236b09ecd75.css><link rel=stylesheet href=https://blog.oddbit.com/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css><link rel=stylesheet href=https://blog.oddbit.com/css/header.min.75c7eb0e2872d95ff48109c6647d0223a38db52e2561dd87966eb5fc7c6bdac6.css><link rel=stylesheet href=https://blog.oddbit.com/css/main.min.36833afd348409fc6c3d09d0897c5833d9d5bf1ff31f5e60ea3ee42ce2b1268c.css><link rel=stylesheet href=https://blog.oddbit.com/css/menu.min.3c17467ebeb3d38663dce68f71f519901124fa5cbb4519b2fb0667a21e9aca39.css><link rel=stylesheet href=https://blog.oddbit.com/css/pagination.min.bbb986dbce00a5ce5aca0504b7925fc1c581992a4bf57f163e5d69cc1db7d836.css><link rel=stylesheet href=https://blog.oddbit.com/css/post.min.e6dddd258e64c83e05cec0cd49c05216742d42fc8ecbfbe6b67083412b609bd3.css><link rel=stylesheet href=https://blog.oddbit.com/css/syntax.min.a0773cce9310cb6d8ed23e50f005448facf29a53001b57e038828daa466b25c0.css><link rel=stylesheet href=https://blog.oddbit.com/css/terminal.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.css><link rel=stylesheet href=https://blog.oddbit.com/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css><link rel=stylesheet href=https://blog.oddbit.com/style.css><link rel="shortcut icon" href=https://blog.oddbit.com/favicon.png><link rel=apple-touch-icon href=https://blog.oddbit.com/apple-touch-icon.png><meta name=twitter:card content="summary"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Avoid rebase hell: squashing without rebasing"><meta property="og:description" content="You&rsquo;re working on a pull request. You&rsquo;ve been working on a pull request for a while, and due to lack of sleep or inebriation you&rsquo;ve been merging changes into your feature branch rather than rebasing. You now have a pull request that looks like this (I&rsquo;ve marked merge commits with the text [merge]):
7e181479 Adds methods for widget sales 0487162 [merge] Merge remote-tracking branch 'origin/master' into my_feature 76ee81c [merge] Merge branch 'my_feature' of https://github.com/my_user_name/widgets into my_feature 981aab4 Adds api for the widget service. b048836 Includes fixes suggested by reviewer. 3dd0c22 adds changes requested by reviewer 5891db2 [merge] fixing merge conflicts 2e226e4 fixes suggestions given by the reviewer da1e85c Adds gadget related API spec c555cc1 Adds doodad related API spec e5beb3e Adds api for update and delete of widgets c43bade Adds api for creating widgets deaa962 Adds all get methods for listing widgets 9de79ab Adds api for showing a widget and simple data model 8288ab1 Adds api framework for widget service You know that&rsquo;s a mess, so you try to fix it by running git rebase -i master and squashing everything together&mldr;and you find yourself stuck in an endless maze of merge conflicts. There has to be a better way!
"><meta property="og:url" content="https://blog.oddbit.com/post/2019-06-17-avoid-rebase-hell-squashing-wi/"><meta property="og:site_name" content="blog.oddbit.com"><meta property="og:image" content="https://blog.oddbit.com/og-image.png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><meta property="article:section" content="tech"><meta property="article:published_time" content="2019-06-17 00:00:00 +0000 UTC"></head><body><div class="container center"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>the odd bit blog</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/>/</a></li><li><a href=https://oddbit.com>/about</a></li><li><a href=/posts>/posts</a></li><li><a href=/tags>/tags</a></li><li><a href=/archive>/archive</a></li><li><a href=/rss.xml>/feed</a></li><li><a href=https://github.com/larsks>→Github</a></li><li><a href=https://hachyderm.io/@larsks>→Mastodon</a></li><li><a href=https://twitter.com/larsks>→Twitter</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/>/</a></li><li><a href=https://oddbit.com>/about</a></li><li><a href=/posts>/posts</a></li><li><a href=/tags>/tags</a></li><li><a href=/archive>/archive</a></li><li><a href=/rss.xml>/feed</a></li><li><ul class=menu><li class=menu__trigger>&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=https://github.com/larsks>→Github</a></li><li><a href=https://hachyderm.io/@larsks>→Mastodon</a></li><li><a href=https://twitter.com/larsks>→Twitter</a></li></ul></li></ul></li></ul></nav></header><div class=content><article class=post><h1 class=post-title><a href=https://blog.oddbit.com/post/2019-06-17-avoid-rebase-hell-squashing-wi/>Avoid rebase hell: squashing without rebasing</a></h1><div class=post-meta><time class=post-date>2019-06-17&nbsp;[Updated: 2023-02-16]</time></div><span class=post-tags>#<a href=https://blog.oddbit.com/tags/git/>git</a>&nbsp;</span><div class=post-content><div><p>You&rsquo;re working on a pull request. You&rsquo;ve been working on a pull request for a while, and due to lack of sleep or inebriation you&rsquo;ve been merging changes into your feature branch rather than rebasing. You now have a pull request that looks like this (I&rsquo;ve marked merge commits with the text <code>[merge]</code>):</p><pre tabindex=0><code>7e181479 Adds methods for widget sales
0487162 [merge] Merge remote-tracking branch &#39;origin/master&#39; into my_feature
76ee81c [merge] Merge branch &#39;my_feature&#39; of https://github.com/my_user_name/widgets into my_feature
981aab4 Adds api for the widget service.
b048836 Includes fixes suggested by reviewer.
3dd0c22 adds changes requested by reviewer
5891db2 [merge] fixing merge conflicts
2e226e4 fixes suggestions given by the reviewer
da1e85c Adds gadget related API spec
c555cc1 Adds doodad related API spec
e5beb3e Adds api for update and delete of widgets
c43bade Adds api for creating widgets
deaa962 Adds all get methods for listing widgets
9de79ab Adds api for showing a widget and simple data model
8288ab1 Adds api framework for widget service
</code></pre><p>You know that&rsquo;s a mess, so you try to fix it by running <code>git rebase -i master</code> and squashing everything together&mldr;and you find yourself stuck in an endless maze of merge conflicts. There has to be a better way!</p><p><em>(voiceover: there is a better way&mldr;)</em></p><h2 id=option-1-merge-squash>Option 1: merge &ndash;squash<a href=#option-1-merge-squash class=hanchor arialabel=Anchor>#</a></h2><p>In this method, you will create a temporary branch and use <code>git merge --squash</code> to squash together the changes in your pull request.</p><ol><li><p>Check out a new branch based on <code>master</code> (or the appropriate base branch if your feature branch isn&rsquo;t based on <code>master</code>):</p><pre tabindex=0><code>git checkout -b work master
</code></pre><p>(This creates a new branch called <code>work</code> and makes that your current branch.)</p></li><li><p>Bring in the changes from your messy pull request using <code>git merge --squash</code>:</p><pre tabindex=0><code>git merge --squash my_feature
</code></pre><p>This brings in all the changes from your <code>my_feature</code> branch and stages them, but does not create <em>any</em> commits.</p></li><li><p>Commit the changes with an appropriate commit message:</p><pre tabindex=0><code>git commit
</code></pre><p>At this point, your <code>work</code> branch should be identical to the original <code>my_feature</code> branch (running <code>git diff my_feature_branch</code> should not show any changes), but it will have only a single commit after <code>master</code>.</p></li><li><p>Return to your feature branch and <code>reset</code> it to the squashed version:</p><pre tabindex=0><code>git checkout my_feature
git reset --hard work
</code></pre></li><li><p>Update your pull request:</p><pre tabindex=0><code>git push -f
</code></pre></li><li><p>Optionally clean up your work branch:</p><pre tabindex=0><code>git branch -D work
</code></pre></li></ol><h2 id=option-2-using-git-commit-tree>Option 2: Using <code>git commit-tree</code><a href=#option-2-using-git-commit-tree class=hanchor arialabel=Anchor>#</a></h2><p>In this method, you will use <code>git commit-tree</code> to create a new commit without requiring a temporary branch.</p><ol><li><p>Use <code>git commit-tree</code> to create new commit that reproduces the current state of your <code>my_feature</code> branch but</p><pre tabindex=0><code>git commit-tree -p master -m &#39;this implements my_feature&#39; my_feature^{tree}
</code></pre><p>This uses the current state of the <code>my_feature</code> branch as the source of a new commit whose parent is <code>master</code>. This will print out a commit hash:</p><pre tabindex=0><code>1d3917a3b7c43f4585084e626303c9eeee59c6d6
</code></pre></li><li><p>Reset your <code>my_feature</code> branch to this new commit hash:</p><pre tabindex=0><code>git reset --hard 1d3917a3b7c43f4585084e626303c9eeee59c6d6
</code></pre></li><li><p>Consider editing your commit message to meet <a href=https://blog.oddbit.com/post/2019-06-14-git-etiquette-commit-messages/>best practices</a>.</p></li><li><p>Update your pull request:</p><pre tabindex=0><code>git push -f
</code></pre></li></ol></div></div><script src=https://utteranc.es/client.js repo=larsks/blog.oddbit.com issue-term=pathname label=comment theme=github-light crossorigin=anonymous async></script></article></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user"><span>Lars Kellogg-Stedman</span>
<span>:: <a href=https://github.com/panr/hugo-theme-terminal target=_blank>Theme</a> made by <a href=https://github.com/panr target=_blank>panr</a></span></div></div></footer><script type=text/javascript src=/bundle.min.js></script><script src=/js/mermaid.min.js></script><script>mermaid.initialize({startOnLoad:!0})</script></div></body></html>