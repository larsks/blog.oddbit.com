<!doctype html><html lang=en><head><title>Enphase Envoy XML Data Format :: blog.oddbit.com</title>
<meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="We recently installed a (photovoltaic) solar array on our house. The system uses Enphase microinverters, and includes a monitoring device called the &amp;ldquo;Envoy&amp;rdquo;. The Envoy collects data from the microinverters and sends it back to Enphase. Enphase performs monitoring services for the array and also provides access to the data collected by the Envoy product.
I&amp;rsquo;m interested in getting direct access to the data provided by the Envoy. In pursuit of that goal, I set up a man-in-the-middle proxy server on my home network to intercept the communication from the Envoy to the Enphase servers."><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://blog.oddbit.com/post/2012-02-13-enphase-envoy-xml-data-format/><script async src="https://www.googletagmanager.com/gtag/js?id=G-G1FYT93ENG"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-G1FYT93ENG")}</script><link rel=stylesheet href=https://blog.oddbit.com/styles.css><link rel=stylesheet href=https://blog.oddbit.com/style.css><link rel="shortcut icon" href=https://blog.oddbit.com/img/theme-colors/orange.png><link rel=apple-touch-icon href=https://blog.oddbit.com/img/theme-colors/orange.png><meta name=twitter:card content="summary"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Enphase Envoy XML Data Format"><meta property="og:description" content="We recently installed a (photovoltaic) solar array on our house. The system uses Enphase microinverters, and includes a monitoring device called the &amp;ldquo;Envoy&amp;rdquo;. The Envoy collects data from the microinverters and sends it back to Enphase. Enphase performs monitoring services for the array and also provides access to the data collected by the Envoy product.
I&amp;rsquo;m interested in getting direct access to the data provided by the Envoy. In pursuit of that goal, I set up a man-in-the-middle proxy server on my home network to intercept the communication from the Envoy to the Enphase servers."><meta property="og:url" content="https://blog.oddbit.com/post/2012-02-13-enphase-envoy-xml-data-format/"><meta property="og:site_name" content="blog.oddbit.com"><meta property="og:image" content="https://blog.oddbit.com/img/favicon/orange.png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><meta property="article:section" content="tech"><meta property="article:published_time" content="2012-02-13 00:00:00 +0000 UTC"></head><body class=orange><div class="container center headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>the odd bit blog</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/>/</a></li><li><a href=https://oddbit.com>/about</a></li><li><a href=/posts>/posts</a></li><li><a href=/tags>/tags</a></li><li><a href=/archive>/archive</a></li><li><a href=/rss.xml>/feed</a></li><li><a href=https://github.com/larsks>→Github</a></li><li><a href=https://hachyderm.io/@larsks>→Mastodon</a></li><li><a href=https://twitter.com/larsks>→Twitter</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/>/</a></li><li><a href=https://oddbit.com>/about</a></li><li><a href=/posts>/posts</a></li><li><a href=/tags>/tags</a></li><li><a href=/archive>/archive</a></li><li><a href=/rss.xml>/feed</a></li><li><ul class=menu><li class=menu__trigger>&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=https://github.com/larsks>→Github</a></li><li><a href=https://hachyderm.io/@larsks>→Mastodon</a></li><li><a href=https://twitter.com/larsks>→Twitter</a></li></ul></li></ul></li></ul></nav></header><div class=content><article class=post><h1 class=post-title><a href=https://blog.oddbit.com/post/2012-02-13-enphase-envoy-xml-data-format/>Enphase Envoy XML Data Format</a></h1><div class=post-meta><time class=post-date>2012-02-13 ::
[Updated :: 2023-02-16]</time></div><div class=post-content><div><p>We recently installed a (photovoltaic) solar array on our house. The system uses <a href=http://enphase.com/>Enphase</a> microinverters, and includes a monitoring device called the &ldquo;<a href=http://enphase.com/products/envoy/>Envoy</a>&rdquo;. The Envoy collects data from the microinverters and sends it back to Enphase. Enphase performs monitoring services for the array and also provides access to the data collected by the Envoy product.</p><p>I&rsquo;m interested in getting direct access to the data provided by the Envoy. In pursuit of that goal, I set up a man-in-the-middle proxy server on my home network to intercept the communication from the Envoy to the Enphase servers. I&rsquo;m documenting the results of my exploration here in case somebody else finds the information useful.</p><p>The Envoy sends deflate-encoded XML data to the Enphase servers. You can decompress the data using Python&rsquo;s <code>zlib</code> module like this:</p><pre><code>import zlib
xml_data = zlib.decompress(deflate_compressed_data)
</code></pre><p>The request is an http <code>POST</code> to <a href="https://reports.enphaseenergy.com/emu_reports/performance_report?webcomm_version=3.0">https://reports.enphaseenergy.com/emu_reports/performance_report?webcomm_version=3.0</a>. The request headers look like this:</p><pre><code>POST /emu_reports/performance_report?webcomm_version=3.0 HTTP/1.1
Accept: */*
Connection: close
Content-Type: application/x-deflate
Content-Length: 729
Host: reports.enphaseenergy.com:443
</code></pre><p>The request body &ndash; after inflating it &ndash; looks something like this:</p><pre><code>&lt;?xml version='1.0' encoding='utf-8'?&gt;
&lt;perf_report report_timestamp='1329134202'&gt;
  &lt;envoy ip_addr='192.168.1.166' mac_addr='00:11:22:33:44:55'
  timezone='US/Eastern' part_num='800-00024-r04'
  sw_version='R3.0.0 (9720d7)' serial_num='123456115374' /&gt;
  &lt;event correlation_id='161' event_state='1' id='221'
  event_code='10009' eqid='123456102635' serial_num='123456102635'
  event_date='1329134118' /&gt;
  &lt;event correlation_id='194' event_state='1' id='222'
  event_code='101' eqid='123456103685.1' serial_num='123456103685'
  event_date='1329134119' /&gt;
  &lt;event correlation_id='196' event_state='1' id='223'
  event_code='101' eqid='123456105331.1' serial_num='123456105331'
  event_date='1329134120' /&gt;
  &lt;event correlation_id='202' event_state='1' id='224'
  event_code='101' eqid='123456103294.1' serial_num='123456103294'
  event_date='1329134130' /&gt;
  &lt;event correlation_id='206' event_state='1' id='225'
  event_code='101' eqid='123456105321.1' serial_num='123456105321'
  event_date='1329134139' /&gt;
  &lt;event event_state='2' id='226' event_code='101'
  eqid='123456104335.1' serial_num='123456104335'
  event_date='1329134152' /&gt;
  &lt;event event_state='0' id='227' event_code='509'
  eqid='123456104335' serial_num='123456104335'
  event_date='1329134152' /&gt;
  &lt;event correlation_id='213' event_state='1' id='228'
  event_code='101' eqid='123456105296.1' serial_num='123456105296'
  event_date='1329134153' /&gt;
  &lt;device image_bits='131072' device_type='1' admin_state='1'
  condition_flags='2359296' part_num='800-00103-r05'
  observed_flags='0' eqid='123456105041' control_bits='0'&gt;
    &lt;channel channel_type='1' condition_flags='16'
    observed_flags='0' eqid='123456105041.1' control_bits='0' /&gt;
  &lt;/device&gt;
  &lt;device image_bits='131072' device_type='1' admin_state='1'
  condition_flags='2359296' part_num='800-00103-r05'
  observed_flags='0' eqid='123456104335' control_bits='0'&gt;
    &lt;channel channel_type='1' condition_flags='16'
    observed_flags='0' eqid='123456104335.1' control_bits='0' /&gt;
  &lt;/device&gt;
  &lt;device image_bits='131072' device_type='1' admin_state='1'
  condition_flags='2359296' part_num='800-00103-r05'
  observed_flags='0' eqid='123456104246' control_bits='0'&gt;
    &lt;channel channel_type='1' condition_flags='16'
    observed_flags='0' eqid='123456104246.1' control_bits='0' /&gt;
  &lt;/device&gt;
  &lt;device image_bits='131072' device_type='1' admin_state='1'
  condition_flags='2359296' part_num='800-00103-r05'
  observed_flags='0' eqid='123456104224' control_bits='0'&gt;
    &lt;channel channel_type='1' condition_flags='16'
    observed_flags='0' eqid='123456104224.1' control_bits='0' /&gt;
  &lt;/device&gt;
  &lt;device image_bits='131072' device_type='1' admin_state='1'
  condition_flags='2359296' part_num='800-00103-r05'
  observed_flags='0' eqid='123456102776' control_bits='0'&gt;
    &lt;channel channel_type='1' condition_flags='16'
    observed_flags='0' eqid='123456102776.1' control_bits='0' /&gt;
  &lt;/device&gt;
  &lt;device image_bits='131072' device_type='1' admin_state='1'
  condition_flags='2359296' part_num='800-00103-r05'
  observed_flags='0' eqid='123456103271' control_bits='0'&gt;
    &lt;channel channel_type='1' condition_flags='16'
    observed_flags='0' eqid='123456103271.1' control_bits='0' /&gt;
  &lt;/device&gt;
  &lt;device image_bits='131072' device_type='1' admin_state='1'
  condition_flags='2359296' part_num='800-00103-r05'
  observed_flags='0' eqid='123456105190' control_bits='0'&gt;
    &lt;channel channel_type='1' condition_flags='16'
    observed_flags='0' eqid='123456105190.1' control_bits='0' /&gt;
  &lt;/device&gt;
  &lt;device image_bits='131072' device_type='1' admin_state='1'
  condition_flags='2097152' part_num='800-00103-r05'
  observed_flags='0' eqid='123456105321' control_bits='0'&gt;
    &lt;channel channel_type='1' condition_flags='0'
    observed_flags='0' eqid='123456105321.1' control_bits='0' /&gt;
  &lt;/device&gt;
  &lt;device image_bits='131072' device_type='1' admin_state='1'
  condition_flags='2359296' part_num='800-00103-r05'
  observed_flags='0' eqid='123456105178' control_bits='0'&gt;
    &lt;channel channel_type='1' condition_flags='16'
    observed_flags='0' eqid='123456105178.1' control_bits='0' /&gt;
  &lt;/device&gt;
  &lt;device image_bits='131072' device_type='1' admin_state='1'
  condition_flags='2359296' part_num='800-00103-r05'
  observed_flags='0' eqid='123456104988' control_bits='0'&gt;
    &lt;channel channel_type='1' condition_flags='16'
    observed_flags='0' eqid='123456104988.1' control_bits='0' /&gt;
  &lt;/device&gt;
  &lt;device image_bits='131072' device_type='1' admin_state='1'
  condition_flags='2097152' part_num='800-00103-r05'
  observed_flags='0' eqid='123456103294' control_bits='0'&gt;
    &lt;channel channel_type='1' condition_flags='0'
    observed_flags='0' eqid='123456103294.1' control_bits='0' /&gt;
  &lt;/device&gt;
  &lt;device image_bits='131072' device_type='1' admin_state='1'
  condition_flags='2359296' part_num='800-00103-r05'
  observed_flags='0' eqid='123456105346' control_bits='0'&gt;
    &lt;channel channel_type='1' condition_flags='16'
    observed_flags='0' eqid='123456105346.1' control_bits='0' /&gt;
  &lt;/device&gt;
  &lt;device image_bits='131072' device_type='1' admin_state='1'
  condition_flags='2359296' part_num='800-00103-r05'
  observed_flags='0' eqid='123456105297' control_bits='0'&gt;
    &lt;channel channel_type='1' condition_flags='16'
    observed_flags='0' eqid='123456105297.1' control_bits='0' /&gt;
  &lt;/device&gt;
  &lt;device image_bits='131072' device_type='1' admin_state='1'
  condition_flags='2359296' part_num='800-00103-r05'
  observed_flags='0' eqid='123456104896' control_bits='0'&gt;
    &lt;channel channel_type='1' condition_flags='16'
    observed_flags='0' eqid='123456104896.1' control_bits='0' /&gt;
  &lt;/device&gt;
  &lt;device image_bits='131072' device_type='1' admin_state='1'
  condition_flags='2097152' part_num='800-00103-r05'
  observed_flags='0' eqid='123456105331' control_bits='0'&gt;
    &lt;channel channel_type='1' condition_flags='0'
    observed_flags='0' eqid='123456105331.1' control_bits='0' /&gt;
  &lt;/device&gt;
  &lt;device image_bits='131072' device_type='1' admin_state='1'
  condition_flags='2359296' part_num='800-00103-r05'
  observed_flags='0' eqid='123456103546' control_bits='0'&gt;
    &lt;channel channel_type='1' condition_flags='16'
    observed_flags='0' eqid='123456103546.1' control_bits='0' /&gt;
  &lt;/device&gt;
  &lt;device image_bits='131072' device_type='1' admin_state='1'
  condition_flags='2097152' part_num='800-00103-r05'
  observed_flags='0' eqid='123456103685' control_bits='0'&gt;
    &lt;channel channel_type='1' condition_flags='0'
    observed_flags='0' eqid='123456103685.1' control_bits='0' /&gt;
  &lt;/device&gt;
  &lt;device image_bits='131072' device_type='1' admin_state='1'
  condition_flags='2359296' part_num='800-00103-r05'
  observed_flags='0' eqid='123456103215' control_bits='0'&gt;
    &lt;channel channel_type='1' condition_flags='16'
    observed_flags='0' eqid='123456103215.1' control_bits='0' /&gt;
  &lt;/device&gt;
  &lt;device image_bits='131072' device_type='1' admin_state='1'
  condition_flags='2097152' part_num='800-00103-r05'
  observed_flags='0' eqid='123456102635' control_bits='0'&gt;
    &lt;channel channel_type='1' condition_flags='0'
    observed_flags='0' eqid='123456102635.1' control_bits='0' /&gt;
  &lt;/device&gt;
  &lt;device image_bits='131072' device_type='1' admin_state='1'
  condition_flags='2097152' part_num='800-00103-r05'
  observed_flags='0' eqid='123456105296' control_bits='0'&gt;
    &lt;channel channel_type='1' condition_flags='0'
    observed_flags='0' eqid='123456105296.1' control_bits='0' /&gt;
  &lt;/device&gt;
&lt;/perf_report&gt;
</code></pre><p>The response headers look like this:</p><pre><code>HTTP/1.1 200 OK
Date: Mon, 13 Feb 2012 11:56:48 GMT
Server: Apache
X-Powered-By: Phusion Passenger (mod_rails/mod_rack) 3.0.11
ETag: &quot;95bc2eaddfac613540f469946f28af4b&quot;
X-Runtime: 297
Cache-Control: private, max-age=0, must-revalidate
Content-Length: 142
Status: 200
Cache-Control: max-age=31536000
Expires: Tue, 12 Feb 2013 11:56:48 GMT
Connection: close
Content-Type: application/x-deflate; charset=utf-8
</code></pre><p>And the response body &ndash; after inflating it &ndash; looks something like this:</p><pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;perf_report_response status=&quot;success&quot;&gt;
  &lt;events_processed&gt;
    &lt;event id=&quot;221&quot;/&gt;
    &lt;event id=&quot;222&quot;/&gt;
    &lt;event id=&quot;223&quot;/&gt;
    &lt;event id=&quot;224&quot;/&gt;
    &lt;event id=&quot;225&quot;/&gt;
    &lt;event id=&quot;226&quot;/&gt;
    &lt;event id=&quot;227&quot;/&gt;
    &lt;event id=&quot;228&quot;/&gt;
  &lt;/events_processed&gt;
&lt;/perf_report_response&gt;
</code></pre><p>My goal is to set up a simple proxy that in addition to passing the information along to Enphase will also collect it locally. I&rsquo;ll update the blog if I make progress on that front.</p></div></div><script src=https://utteranc.es/client.js repo=larsks/blog.oddbit.com issue-term=pathname label=comment theme=github-light crossorigin=anonymous async></script></article></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user"><span>Lars Kellogg-Stedman</span>
<span>:: <a href=https://github.com/panr/hugo-theme-terminal target=_blank>Theme</a> made by <a href=https://github.com/panr target=_blank>panr</a></span></div></div></footer><script type=text/javascript src=/bundle.min.js></script><script src=/js/mermaid.min.js></script><script>mermaid.initialize({startOnLoad:!0})</script></div></body></html>