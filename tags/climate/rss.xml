<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Climate on blog.oddbit.com</title><link>https://blog.oddbit.com/tags/climate/</link><description>Recent content in Climate on blog.oddbit.com</description><generator>Hugo -- gohugo.io</generator><language>en</language><copyright>Lars Kellogg-Stedman</copyright><lastBuildDate>Thu, 23 Jan 2020 00:00:00 +0000</lastBuildDate><atom:link href="https://blog.oddbit.com/tags/climate/rss.xml" rel="self" type="application/rss+xml"/><item><title>How long is a cold spell in Boston?</title><link>https://blog.oddbit.com/post/2020-01-23-how-long-is-a-cold-spell/</link><pubDate>Thu, 23 Jan 2020 00:00:00 +0000</pubDate><guid>https://blog.oddbit.com/post/2020-01-23-how-long-is-a-cold-spell/</guid><description>&lt;p>We&amp;rsquo;ve had some wacky weather recently. In the space of a week, the temperature went from a high of about 75째F to a low around 15째F. This got me to thinking about what constitutes &amp;ldquo;normal&amp;rdquo; weather here in the Boston area, and in particular, how common it is to have a string of consecutive days in which the high temperature stays below freezing. While this was an interesting question in itself, it also seemed like a great opportunity to learn a little about &lt;a href="https://pandas.pydata.org">Pandas&lt;/a>, the Python data analysis framework.&lt;/p></description><content>&lt;p>We&amp;rsquo;ve had some wacky weather recently. In the space of a week, the temperature went from a high of about 75째F to a low around 15째F. This got me to thinking about what constitutes &amp;ldquo;normal&amp;rdquo; weather here in the Boston area, and in particular, how common it is to have a string of consecutive days in which the high temperature stays below freezing. While this was an interesting question in itself, it also seemed like a great opportunity to learn a little about &lt;a href="https://pandas.pydata.org">Pandas&lt;/a>, the Python data analysis framework.&lt;/p>
&lt;p>The first step was finding an appropriate dataset. &lt;a href="https://www.noaa.gov/">NOAA&lt;/a> provides a &lt;a href="https://www.ncdc.noaa.gov/cdo-web/search?datasetid=GHCND">daily summaries&lt;/a> dataset that includes daily high and low temperature; for Boston, this data extends back to about 1936.&lt;/p>
&lt;p>The next step was figuring how to solve the problem. To be explicit, the question I&amp;rsquo;m trying to answer is:&lt;/p>
&lt;blockquote>
&lt;p>For any given winter, what was the longest consecutive string of days in which the temperature stayed below freezing?&lt;/p>
&lt;/blockquote>
&lt;p>There are several parts to this problem.&lt;/p>
&lt;h2 id="reading-the-data">Reading the data&lt;/h2>
&lt;p>We can read the data using Pandas&amp;rsquo; &lt;code>read_csv&lt;/code> method:&lt;/p>
&lt;pre tabindex="0">&lt;code>df = pandas.read_csv(&amp;#39;boston.csv&amp;#39;)
&lt;/code>&lt;/pre>&lt;p>This assumes of course that we have previously &lt;code>import&lt;/code>ed the Pandas library:&lt;/p>
&lt;pre tabindex="0">&lt;code>import pandas
&lt;/code>&lt;/pre>&lt;p>Now we have a dataframe in &lt;code>df&lt;/code>, but it&amp;rsquo;s using a positional index (i.e., the first item is at index &lt;code>0&lt;/code>, the second at &lt;code>1&lt;/code>, etc), whereas we want it to use a date-based index. The data has a &lt;code>DATE&lt;/code> column that we can turn into an appropriate index like this:&lt;/p>
&lt;pre tabindex="0">&lt;code>df[&amp;#39;DATE&amp;#39;] = pandas.to_datetime(df[&amp;#39;DATE&amp;#39;])
df.set_index(df[&amp;#39;DATE&amp;#39;], inplace=True)
&lt;/code>&lt;/pre>&lt;h2 id="which-winter">Which winter?&lt;/h2>
&lt;p>I need to be able to group the data by &amp;ldquo;winter&amp;rdquo;. For example, dates from December 21, 2018 through March 20, 2019 would all be associated with &amp;ldquo;winter 2018&amp;rdquo;. It would be easy to group the data by &lt;em>year&lt;/em> using Pandas&amp;rsquo; &lt;code>groupby&lt;/code> method:&lt;/p>
&lt;pre tabindex="0">&lt;code>df.groupby(df[&amp;#39;DATE&amp;#39;].dt.year)...
&lt;/code>&lt;/pre>&lt;p>But what&amp;rsquo;s the equivalent for grouping by winter? My first attempt was a naive iterative solution:&lt;/p>
&lt;pre tabindex="0">&lt;code>def get_winter_start(val):
if (val.month == 10 and val.day &amp;gt;= 20) or val.month &amp;gt; 10:
winter = val.year
elif (val.month == 3 and val.day &amp;lt;= 20) or val.month &amp;lt; 3:
winter = val.year-1
else:
winter = 0
return winter
df[&amp;#39;winter_start&amp;#39;] = df[&amp;#39;DATE&amp;#39;].apply(get_winter_start)
&lt;/code>&lt;/pre>&lt;p>This works, but it&amp;rsquo;s not particular graceful and doesn&amp;rsquo;t take advantage of any of the vector operations supported by Pandas. I eventually came up with a different solution. First, create a boolean series that indicates whether a given date is in winter or not:&lt;/p>
&lt;pre tabindex="0">&lt;code>df[&amp;#39;winter&amp;#39;] = (
((df[&amp;#39;DATE&amp;#39;].dt.month == 12) &amp;amp; (df[&amp;#39;DATE&amp;#39;].dt.day &amp;gt;= 20)) |
(df[&amp;#39;DATE&amp;#39;].dt.month &amp;lt; 3) |
((df[&amp;#39;DATE&amp;#39;].dt.month == 3) &amp;amp; (df[&amp;#39;DATE&amp;#39;].dt.day &amp;lt;= 20))
)
&lt;/code>&lt;/pre>&lt;p>Next, use this boolean series to create a new dataframe that contains &lt;em>only&lt;/em> dates in winter. Given this new data, the winter year is the current year for the month of December, or (the current year - 1) for months in Janurary, February, and March:&lt;/p>
&lt;pre tabindex="0">&lt;code>winter = df[df[&amp;#39;winter&amp;#39;]].copy()
winter[&amp;#39;winter_start&amp;#39;] = (
winter[&amp;#39;DATE&amp;#39;].dt.year - (winter[&amp;#39;DATE&amp;#39;].dt.month &amp;lt;= 3))
&lt;/code>&lt;/pre>&lt;p>This seems to do the job. You&amp;rsquo;ll note that in the above expression I&amp;rsquo;m subtracting a boolean from an integer, which is in fact totally legal and I talk about that in more detail &lt;a href="https://blog.oddbit.com/post/2020-01-23-how-long-is-a-cold-spell/#bool">later on&lt;/a> in this article.&lt;/p>
&lt;h2 id="finding-a-sequence-of-consecutive-days-an-iterative-solution">Finding a sequence of consecutive days: an iterative solution&lt;/h2>
&lt;p>To find the longest sequence of days below freezing, I again started with an iterative solution:&lt;/p>
&lt;pre tabindex="0">&lt;code>def max_dbf(val):
acc = []
cur = 0
for i, row in val.iterrows():
if row[&amp;#39;TMAX&amp;#39;] &amp;lt;= 32:
cur += 1
else:
if cur:
acc.append(cur)
cur = 0
if cur:
acc.append(cur)
return max(acc)
&lt;/code>&lt;/pre>&lt;p>Which I applied using Pandas&amp;rsquo; &lt;code>apply&lt;/code> method:&lt;/p>
&lt;pre tabindex="0">&lt;code>res = winter.groupby(&amp;#39;winter_start&amp;#39;).apply(max_dbf)
&lt;/code>&lt;/pre>&lt;p>This time it&amp;rsquo;s not just ugly, but it&amp;rsquo;s also noticeably slow. I started doing some research to figure out how to make it faster.&lt;/p>
&lt;h2 id="finding-a-sequence-of-consecutive-days-a-pandas-solution">Finding a sequence of consecutive days: a Pandas solution&lt;/h2>
&lt;p>In an answer to &lt;a href="https://stackoverflow.com/questions/27626542/counting-consecutive-positive-value-in-python-array">this question&lt;/a> on Stack Overflow, user &lt;a href="https://stackoverflow.com/users/487339/dsm">DSM&lt;/a> suggests that given a series, you can find the longest sequence of consecutive items matching a condition by first creating a boolean series &lt;code>y&lt;/code> that is &lt;code>True&lt;/code> (or &lt;code>1&lt;/code>) for items that match the condition (and &lt;code>False&lt;/code> or &lt;code>0&lt;/code> otherwise), and then running:&lt;/p>
&lt;pre tabindex="0">&lt;code>result = y * (y.groupby((y != y.shift()).cumsum()).cumcount() + 1)
&lt;/code>&lt;/pre>&lt;p>Using that suggestion, I rewrote the &lt;code>max_dbf&lt;/code> method to look like this:&lt;/p>
&lt;pre tabindex="0">&lt;code>def max_dbf(val):
y = val[&amp;#39;TMAX&amp;#39;] &amp;lt;= 32
res = y * (y.groupby((y != y.shift()).cumsum()).cumcount() + 1)
return max(res)
&lt;/code>&lt;/pre>&lt;p>&amp;hellip;and you know what, it works! But what exactly is going on there? There&amp;rsquo;s a reasonable explanation in &lt;a href="https://stackoverflow.com/a/27626699/147356">the answer&lt;/a>, but I&amp;rsquo;m new enough to Pandas that I wanted to work it out for myself.&lt;/p>
&lt;h2 id="setting-the-stage">Setting the stage&lt;/h2>
&lt;p>In order to explore the operation of this expression, let&amp;rsquo;s start with some sample data. This is the value of &lt;code>TMAX&lt;/code> for the month of Janurary, 2018:&lt;/p>
&lt;pre tabindex="0">&lt;code>data = [
[&amp;#39;2018-01-01&amp;#39;, 13],
[&amp;#39;2018-01-02&amp;#39;, 19],
[&amp;#39;2018-01-03&amp;#39;, 29],
[&amp;#39;2018-01-04&amp;#39;, 30],
[&amp;#39;2018-01-05&amp;#39;, 24],
[&amp;#39;2018-01-06&amp;#39;, 12],
[&amp;#39;2018-01-07&amp;#39;, 17],
[&amp;#39;2018-01-08&amp;#39;, 35],
[&amp;#39;2018-01-09&amp;#39;, 43],
[&amp;#39;2018-01-10&amp;#39;, 36],
[&amp;#39;2018-01-11&amp;#39;, 51],
[&amp;#39;2018-01-12&amp;#39;, 60],
[&amp;#39;2018-01-13&amp;#39;, 61],
[&amp;#39;2018-01-14&amp;#39;, 23],
[&amp;#39;2018-01-15&amp;#39;, 21],
[&amp;#39;2018-01-16&amp;#39;, 33],
[&amp;#39;2018-01-17&amp;#39;, 34],
[&amp;#39;2018-01-18&amp;#39;, 32],
[&amp;#39;2018-01-19&amp;#39;, 34],
[&amp;#39;2018-01-20&amp;#39;, 47],
[&amp;#39;2018-01-21&amp;#39;, 49],
[&amp;#39;2018-01-22&amp;#39;, 39],
[&amp;#39;2018-01-23&amp;#39;, 55],
[&amp;#39;2018-01-24&amp;#39;, 42],
[&amp;#39;2018-01-25&amp;#39;, 30],
[&amp;#39;2018-01-26&amp;#39;, 34],
[&amp;#39;2018-01-27&amp;#39;, 53],
[&amp;#39;2018-01-28&amp;#39;, 52],
[&amp;#39;2018-01-29&amp;#39;, 43],
[&amp;#39;2018-01-30&amp;#39;, 31],
[&amp;#39;2018-01-31&amp;#39;, 30],
]
data_unzipped = list(zip(*data))
df = pandas.DataFrame({&amp;#39;DATE&amp;#39;: data_unzipped[0], &amp;#39;TMAX&amp;#39;: data_unzipped[1]})
&lt;/code>&lt;/pre>&lt;p>Our initial dataframe looks like this:&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align: left">&lt;/th>
&lt;th style="text-align: left">DATE&lt;/th>
&lt;th style="text-align: left">TMAX&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align: left">0&lt;/td>
&lt;td style="text-align: left">2018-01-01&lt;/td>
&lt;td style="text-align: left">13&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">1&lt;/td>
&lt;td style="text-align: left">2018-01-02&lt;/td>
&lt;td style="text-align: left">19&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">2&lt;/td>
&lt;td style="text-align: left">2018-01-03&lt;/td>
&lt;td style="text-align: left">29&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">3&lt;/td>
&lt;td style="text-align: left">2018-01-04&lt;/td>
&lt;td style="text-align: left">30&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">4&lt;/td>
&lt;td style="text-align: left">2018-01-05&lt;/td>
&lt;td style="text-align: left">24&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">5&lt;/td>
&lt;td style="text-align: left">2018-01-06&lt;/td>
&lt;td style="text-align: left">12&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">6&lt;/td>
&lt;td style="text-align: left">2018-01-07&lt;/td>
&lt;td style="text-align: left">17&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">7&lt;/td>
&lt;td style="text-align: left">2018-01-08&lt;/td>
&lt;td style="text-align: left">35&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">8&lt;/td>
&lt;td style="text-align: left">2018-01-09&lt;/td>
&lt;td style="text-align: left">43&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">9&lt;/td>
&lt;td style="text-align: left">2018-01-10&lt;/td>
&lt;td style="text-align: left">36&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">10&lt;/td>
&lt;td style="text-align: left">2018-01-11&lt;/td>
&lt;td style="text-align: left">51&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">11&lt;/td>
&lt;td style="text-align: left">2018-01-12&lt;/td>
&lt;td style="text-align: left">60&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">12&lt;/td>
&lt;td style="text-align: left">2018-01-13&lt;/td>
&lt;td style="text-align: left">61&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">13&lt;/td>
&lt;td style="text-align: left">2018-01-14&lt;/td>
&lt;td style="text-align: left">23&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">14&lt;/td>
&lt;td style="text-align: left">2018-01-15&lt;/td>
&lt;td style="text-align: left">21&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">15&lt;/td>
&lt;td style="text-align: left">2018-01-16&lt;/td>
&lt;td style="text-align: left">33&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">16&lt;/td>
&lt;td style="text-align: left">2018-01-17&lt;/td>
&lt;td style="text-align: left">34&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">17&lt;/td>
&lt;td style="text-align: left">2018-01-18&lt;/td>
&lt;td style="text-align: left">32&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">18&lt;/td>
&lt;td style="text-align: left">2018-01-19&lt;/td>
&lt;td style="text-align: left">34&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">19&lt;/td>
&lt;td style="text-align: left">2018-01-20&lt;/td>
&lt;td style="text-align: left">47&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">20&lt;/td>
&lt;td style="text-align: left">2018-01-21&lt;/td>
&lt;td style="text-align: left">49&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">21&lt;/td>
&lt;td style="text-align: left">2018-01-22&lt;/td>
&lt;td style="text-align: left">39&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">22&lt;/td>
&lt;td style="text-align: left">2018-01-23&lt;/td>
&lt;td style="text-align: left">55&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">23&lt;/td>
&lt;td style="text-align: left">2018-01-24&lt;/td>
&lt;td style="text-align: left">42&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">24&lt;/td>
&lt;td style="text-align: left">2018-01-25&lt;/td>
&lt;td style="text-align: left">30&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">25&lt;/td>
&lt;td style="text-align: left">2018-01-26&lt;/td>
&lt;td style="text-align: left">34&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">26&lt;/td>
&lt;td style="text-align: left">2018-01-27&lt;/td>
&lt;td style="text-align: left">53&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">27&lt;/td>
&lt;td style="text-align: left">2018-01-28&lt;/td>
&lt;td style="text-align: left">52&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">28&lt;/td>
&lt;td style="text-align: left">2018-01-29&lt;/td>
&lt;td style="text-align: left">43&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">29&lt;/td>
&lt;td style="text-align: left">2018-01-30&lt;/td>
&lt;td style="text-align: left">31&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">30&lt;/td>
&lt;td style="text-align: left">2018-01-31&lt;/td>
&lt;td style="text-align: left">30&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3 id="step-1">Step 1&lt;/h3>
&lt;p>We first need to create a boolean series indicating whether or not the temperature is below freezing. We&amp;rsquo;ll put this into the dataframe as series &lt;code>freezing&lt;/code>:&lt;/p>
&lt;pre tabindex="0">&lt;code>df[&amp;#39;freezing&amp;#39;] = df[&amp;#39;TMAX&amp;#39;] &amp;lt;= 32
&lt;/code>&lt;/pre>&lt;p>Our dataframe now looks like this:&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align: left">&lt;/th>
&lt;th style="text-align: left">DATE&lt;/th>
&lt;th style="text-align: left">TMAX&lt;/th>
&lt;th style="text-align: left">freezing&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align: left">0&lt;/td>
&lt;td style="text-align: left">2018-01-01&lt;/td>
&lt;td style="text-align: left">13&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">1&lt;/td>
&lt;td style="text-align: left">2018-01-02&lt;/td>
&lt;td style="text-align: left">19&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">2&lt;/td>
&lt;td style="text-align: left">2018-01-03&lt;/td>
&lt;td style="text-align: left">29&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">3&lt;/td>
&lt;td style="text-align: left">2018-01-04&lt;/td>
&lt;td style="text-align: left">30&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">4&lt;/td>
&lt;td style="text-align: left">2018-01-05&lt;/td>
&lt;td style="text-align: left">24&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">5&lt;/td>
&lt;td style="text-align: left">2018-01-06&lt;/td>
&lt;td style="text-align: left">12&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">6&lt;/td>
&lt;td style="text-align: left">2018-01-07&lt;/td>
&lt;td style="text-align: left">17&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">7&lt;/td>
&lt;td style="text-align: left">2018-01-08&lt;/td>
&lt;td style="text-align: left">35&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">8&lt;/td>
&lt;td style="text-align: left">2018-01-09&lt;/td>
&lt;td style="text-align: left">43&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">9&lt;/td>
&lt;td style="text-align: left">2018-01-10&lt;/td>
&lt;td style="text-align: left">36&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">10&lt;/td>
&lt;td style="text-align: left">2018-01-11&lt;/td>
&lt;td style="text-align: left">51&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">11&lt;/td>
&lt;td style="text-align: left">2018-01-12&lt;/td>
&lt;td style="text-align: left">60&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">12&lt;/td>
&lt;td style="text-align: left">2018-01-13&lt;/td>
&lt;td style="text-align: left">61&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">13&lt;/td>
&lt;td style="text-align: left">2018-01-14&lt;/td>
&lt;td style="text-align: left">23&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">14&lt;/td>
&lt;td style="text-align: left">2018-01-15&lt;/td>
&lt;td style="text-align: left">21&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">15&lt;/td>
&lt;td style="text-align: left">2018-01-16&lt;/td>
&lt;td style="text-align: left">33&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">16&lt;/td>
&lt;td style="text-align: left">2018-01-17&lt;/td>
&lt;td style="text-align: left">34&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">17&lt;/td>
&lt;td style="text-align: left">2018-01-18&lt;/td>
&lt;td style="text-align: left">32&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">18&lt;/td>
&lt;td style="text-align: left">2018-01-19&lt;/td>
&lt;td style="text-align: left">34&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">19&lt;/td>
&lt;td style="text-align: left">2018-01-20&lt;/td>
&lt;td style="text-align: left">47&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">20&lt;/td>
&lt;td style="text-align: left">2018-01-21&lt;/td>
&lt;td style="text-align: left">49&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">21&lt;/td>
&lt;td style="text-align: left">2018-01-22&lt;/td>
&lt;td style="text-align: left">39&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">22&lt;/td>
&lt;td style="text-align: left">2018-01-23&lt;/td>
&lt;td style="text-align: left">55&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">23&lt;/td>
&lt;td style="text-align: left">2018-01-24&lt;/td>
&lt;td style="text-align: left">42&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">24&lt;/td>
&lt;td style="text-align: left">2018-01-25&lt;/td>
&lt;td style="text-align: left">30&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">25&lt;/td>
&lt;td style="text-align: left">2018-01-26&lt;/td>
&lt;td style="text-align: left">34&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">26&lt;/td>
&lt;td style="text-align: left">2018-01-27&lt;/td>
&lt;td style="text-align: left">53&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">27&lt;/td>
&lt;td style="text-align: left">2018-01-28&lt;/td>
&lt;td style="text-align: left">52&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">28&lt;/td>
&lt;td style="text-align: left">2018-01-29&lt;/td>
&lt;td style="text-align: left">43&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">29&lt;/td>
&lt;td style="text-align: left">2018-01-30&lt;/td>
&lt;td style="text-align: left">31&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">30&lt;/td>
&lt;td style="text-align: left">2018-01-31&lt;/td>
&lt;td style="text-align: left">30&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3 id="step-2">Step 2&lt;/h3>
&lt;p>Now we start looking at the various components in our expression of interest. In this step, we are looking at the highlighted part below:&lt;/p>
&lt;!-- raw HTML omitted -->
&lt;p>Instead of &lt;code>y&lt;/code>, we&amp;rsquo;re operating on the result of the previous step, &lt;code>df['freezing']&lt;/code>. We&amp;rsquo;ll place the result of this step into a new series named &lt;code>step2&lt;/code> in the dataframe:&lt;/p>
&lt;pre tabindex="0">&lt;code>df[&amp;#39;step2&amp;#39;] = df[&amp;#39;freezing&amp;#39;] != df[&amp;#39;freezing&amp;#39;].shift()
&lt;/code>&lt;/pre>&lt;p>This gives us the following:&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align: left">&lt;/th>
&lt;th style="text-align: left">DATE&lt;/th>
&lt;th style="text-align: left">TMAX&lt;/th>
&lt;th style="text-align: left">freezing&lt;/th>
&lt;th style="text-align: left">step2&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align: left">0&lt;/td>
&lt;td style="text-align: left">2018-01-01&lt;/td>
&lt;td style="text-align: left">13&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">1&lt;/td>
&lt;td style="text-align: left">2018-01-02&lt;/td>
&lt;td style="text-align: left">19&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">2&lt;/td>
&lt;td style="text-align: left">2018-01-03&lt;/td>
&lt;td style="text-align: left">29&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">3&lt;/td>
&lt;td style="text-align: left">2018-01-04&lt;/td>
&lt;td style="text-align: left">30&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">4&lt;/td>
&lt;td style="text-align: left">2018-01-05&lt;/td>
&lt;td style="text-align: left">24&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">5&lt;/td>
&lt;td style="text-align: left">2018-01-06&lt;/td>
&lt;td style="text-align: left">12&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">6&lt;/td>
&lt;td style="text-align: left">2018-01-07&lt;/td>
&lt;td style="text-align: left">17&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">7&lt;/td>
&lt;td style="text-align: left">2018-01-08&lt;/td>
&lt;td style="text-align: left">35&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">8&lt;/td>
&lt;td style="text-align: left">2018-01-09&lt;/td>
&lt;td style="text-align: left">43&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">9&lt;/td>
&lt;td style="text-align: left">2018-01-10&lt;/td>
&lt;td style="text-align: left">36&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">10&lt;/td>
&lt;td style="text-align: left">2018-01-11&lt;/td>
&lt;td style="text-align: left">51&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">11&lt;/td>
&lt;td style="text-align: left">2018-01-12&lt;/td>
&lt;td style="text-align: left">60&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">12&lt;/td>
&lt;td style="text-align: left">2018-01-13&lt;/td>
&lt;td style="text-align: left">61&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">13&lt;/td>
&lt;td style="text-align: left">2018-01-14&lt;/td>
&lt;td style="text-align: left">23&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">14&lt;/td>
&lt;td style="text-align: left">2018-01-15&lt;/td>
&lt;td style="text-align: left">21&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">15&lt;/td>
&lt;td style="text-align: left">2018-01-16&lt;/td>
&lt;td style="text-align: left">33&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">16&lt;/td>
&lt;td style="text-align: left">2018-01-17&lt;/td>
&lt;td style="text-align: left">34&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">17&lt;/td>
&lt;td style="text-align: left">2018-01-18&lt;/td>
&lt;td style="text-align: left">32&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">18&lt;/td>
&lt;td style="text-align: left">2018-01-19&lt;/td>
&lt;td style="text-align: left">34&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">19&lt;/td>
&lt;td style="text-align: left">2018-01-20&lt;/td>
&lt;td style="text-align: left">47&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">20&lt;/td>
&lt;td style="text-align: left">2018-01-21&lt;/td>
&lt;td style="text-align: left">49&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">21&lt;/td>
&lt;td style="text-align: left">2018-01-22&lt;/td>
&lt;td style="text-align: left">39&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">22&lt;/td>
&lt;td style="text-align: left">2018-01-23&lt;/td>
&lt;td style="text-align: left">55&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">23&lt;/td>
&lt;td style="text-align: left">2018-01-24&lt;/td>
&lt;td style="text-align: left">42&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">24&lt;/td>
&lt;td style="text-align: left">2018-01-25&lt;/td>
&lt;td style="text-align: left">30&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">25&lt;/td>
&lt;td style="text-align: left">2018-01-26&lt;/td>
&lt;td style="text-align: left">34&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">26&lt;/td>
&lt;td style="text-align: left">2018-01-27&lt;/td>
&lt;td style="text-align: left">53&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">27&lt;/td>
&lt;td style="text-align: left">2018-01-28&lt;/td>
&lt;td style="text-align: left">52&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">28&lt;/td>
&lt;td style="text-align: left">2018-01-29&lt;/td>
&lt;td style="text-align: left">43&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">29&lt;/td>
&lt;td style="text-align: left">2018-01-30&lt;/td>
&lt;td style="text-align: left">31&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">30&lt;/td>
&lt;td style="text-align: left">2018-01-31&lt;/td>
&lt;td style="text-align: left">30&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>Looking at the values of &lt;code>step2&lt;/code> in this table, we can see an interesting property: &lt;code>step2&lt;/code> is &lt;code>True&lt;/code> only in cases where the value of &lt;code>df['freezing']&lt;/code> changes.&lt;/p>
&lt;h3 id="step-3">Step 3&lt;/h3>
&lt;!-- raw HTML omitted -->
&lt;p>In this step, we apply the &lt;a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.cumsum.html">cumsum&lt;/a> method (&amp;ldquo;cumulative sum&amp;rdquo;) to the result of step 2. We store the result in a new series &lt;code>step3&lt;/code> in the dataframe:&lt;/p>
&lt;pre tabindex="0">&lt;code>df[&amp;#39;step3&amp;#39;] = df[&amp;#39;step2&amp;#39;].cumsum()
&lt;/code>&lt;/pre>&lt;p>The result looks like this:&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align: left">&lt;/th>
&lt;th style="text-align: left">DATE&lt;/th>
&lt;th style="text-align: left">TMAX&lt;/th>
&lt;th style="text-align: left">freezing&lt;/th>
&lt;th style="text-align: left">step2&lt;/th>
&lt;th style="text-align: left">step3&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align: left">0&lt;/td>
&lt;td style="text-align: left">2018-01-01&lt;/td>
&lt;td style="text-align: left">13&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">1&lt;/td>
&lt;td style="text-align: left">2018-01-02&lt;/td>
&lt;td style="text-align: left">19&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">2&lt;/td>
&lt;td style="text-align: left">2018-01-03&lt;/td>
&lt;td style="text-align: left">29&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">3&lt;/td>
&lt;td style="text-align: left">2018-01-04&lt;/td>
&lt;td style="text-align: left">30&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">4&lt;/td>
&lt;td style="text-align: left">2018-01-05&lt;/td>
&lt;td style="text-align: left">24&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">5&lt;/td>
&lt;td style="text-align: left">2018-01-06&lt;/td>
&lt;td style="text-align: left">12&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">6&lt;/td>
&lt;td style="text-align: left">2018-01-07&lt;/td>
&lt;td style="text-align: left">17&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">7&lt;/td>
&lt;td style="text-align: left">2018-01-08&lt;/td>
&lt;td style="text-align: left">35&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">2&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">8&lt;/td>
&lt;td style="text-align: left">2018-01-09&lt;/td>
&lt;td style="text-align: left">43&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">2&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">9&lt;/td>
&lt;td style="text-align: left">2018-01-10&lt;/td>
&lt;td style="text-align: left">36&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">2&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">10&lt;/td>
&lt;td style="text-align: left">2018-01-11&lt;/td>
&lt;td style="text-align: left">51&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">2&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">11&lt;/td>
&lt;td style="text-align: left">2018-01-12&lt;/td>
&lt;td style="text-align: left">60&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">2&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">12&lt;/td>
&lt;td style="text-align: left">2018-01-13&lt;/td>
&lt;td style="text-align: left">61&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">2&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">13&lt;/td>
&lt;td style="text-align: left">2018-01-14&lt;/td>
&lt;td style="text-align: left">23&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">3&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">14&lt;/td>
&lt;td style="text-align: left">2018-01-15&lt;/td>
&lt;td style="text-align: left">21&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">3&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">15&lt;/td>
&lt;td style="text-align: left">2018-01-16&lt;/td>
&lt;td style="text-align: left">33&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">4&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">16&lt;/td>
&lt;td style="text-align: left">2018-01-17&lt;/td>
&lt;td style="text-align: left">34&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">4&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">17&lt;/td>
&lt;td style="text-align: left">2018-01-18&lt;/td>
&lt;td style="text-align: left">32&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">5&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">18&lt;/td>
&lt;td style="text-align: left">2018-01-19&lt;/td>
&lt;td style="text-align: left">34&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">6&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">19&lt;/td>
&lt;td style="text-align: left">2018-01-20&lt;/td>
&lt;td style="text-align: left">47&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">6&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">20&lt;/td>
&lt;td style="text-align: left">2018-01-21&lt;/td>
&lt;td style="text-align: left">49&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">6&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">21&lt;/td>
&lt;td style="text-align: left">2018-01-22&lt;/td>
&lt;td style="text-align: left">39&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">6&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">22&lt;/td>
&lt;td style="text-align: left">2018-01-23&lt;/td>
&lt;td style="text-align: left">55&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">6&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">23&lt;/td>
&lt;td style="text-align: left">2018-01-24&lt;/td>
&lt;td style="text-align: left">42&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">6&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">24&lt;/td>
&lt;td style="text-align: left">2018-01-25&lt;/td>
&lt;td style="text-align: left">30&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">7&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">25&lt;/td>
&lt;td style="text-align: left">2018-01-26&lt;/td>
&lt;td style="text-align: left">34&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">8&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">26&lt;/td>
&lt;td style="text-align: left">2018-01-27&lt;/td>
&lt;td style="text-align: left">53&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">8&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">27&lt;/td>
&lt;td style="text-align: left">2018-01-28&lt;/td>
&lt;td style="text-align: left">52&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">8&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">28&lt;/td>
&lt;td style="text-align: left">2018-01-29&lt;/td>
&lt;td style="text-align: left">43&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">8&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">29&lt;/td>
&lt;td style="text-align: left">2018-01-30&lt;/td>
&lt;td style="text-align: left">31&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">9&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">30&lt;/td>
&lt;td style="text-align: left">2018-01-31&lt;/td>
&lt;td style="text-align: left">30&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">9&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>We&amp;rsquo;re applying the &lt;code>cumsum&lt;/code> method to a boolean series. By doing so, we&amp;rsquo;re taking advantage of the fact that in Python &lt;a href="https://docs.python.org/release/3.0.1/reference/datamodel.html#the-standard-type-hierarchy">we can treat boolean values as integers&lt;/a>: a &lt;code>True&lt;/code> value evaluates to &lt;code>1&lt;/code>, and a &lt;code>False&lt;/code> value to &lt;code>0&lt;/code>. What we get with this operation is effectively a &amp;ldquo;sequence id&amp;rdquo;: because &lt;code>step2&lt;/code> is only &lt;code>True&lt;/code> when the value of &lt;code>freezing&lt;/code> changes, the value calculated in this step only increments when we start a new sequence of values for which &lt;code>freezing&lt;/code> has the same value.&lt;/p>
&lt;h3 id="step-4">Step 4&lt;/h3>
&lt;!-- raw HTML omitted -->
&lt;p>In the previous step, we calculated what I called a &amp;ldquo;sequence id&amp;rdquo;. We can take advantage of this to group the data into consecutive stretches for which the temperature was either below freezing or not by using the value as an argument to Pandas&amp;rsquo; &lt;code>groupby&lt;/code> method, and then applying the &lt;a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.core.groupby.GroupBy.cumcount.html">cumcount&lt;/a> method:&lt;/p>
&lt;pre tabindex="0">&lt;code>df[&amp;#39;step4&amp;#39;] = df[&amp;#39;freezing&amp;#39;].groupby(df[&amp;#39;step3&amp;#39;]).cumcount() + 1
&lt;/code>&lt;/pre>&lt;p>The &lt;code>cumcount&lt;/code> method simply numbers the items in each group, starting at 0. This gives us:&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align: left">&lt;/th>
&lt;th style="text-align: left">DATE&lt;/th>
&lt;th style="text-align: left">TMAX&lt;/th>
&lt;th style="text-align: left">freezing&lt;/th>
&lt;th style="text-align: left">step2&lt;/th>
&lt;th style="text-align: left">step3&lt;/th>
&lt;th style="text-align: left">step4&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align: left">0&lt;/td>
&lt;td style="text-align: left">2018-01-01&lt;/td>
&lt;td style="text-align: left">13&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">1&lt;/td>
&lt;td style="text-align: left">2018-01-02&lt;/td>
&lt;td style="text-align: left">19&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;td style="text-align: left">2&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">2&lt;/td>
&lt;td style="text-align: left">2018-01-03&lt;/td>
&lt;td style="text-align: left">29&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;td style="text-align: left">3&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">3&lt;/td>
&lt;td style="text-align: left">2018-01-04&lt;/td>
&lt;td style="text-align: left">30&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;td style="text-align: left">4&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">4&lt;/td>
&lt;td style="text-align: left">2018-01-05&lt;/td>
&lt;td style="text-align: left">24&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;td style="text-align: left">5&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">5&lt;/td>
&lt;td style="text-align: left">2018-01-06&lt;/td>
&lt;td style="text-align: left">12&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;td style="text-align: left">6&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">6&lt;/td>
&lt;td style="text-align: left">2018-01-07&lt;/td>
&lt;td style="text-align: left">17&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;td style="text-align: left">7&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">7&lt;/td>
&lt;td style="text-align: left">2018-01-08&lt;/td>
&lt;td style="text-align: left">35&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">2&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">8&lt;/td>
&lt;td style="text-align: left">2018-01-09&lt;/td>
&lt;td style="text-align: left">43&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">2&lt;/td>
&lt;td style="text-align: left">2&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">9&lt;/td>
&lt;td style="text-align: left">2018-01-10&lt;/td>
&lt;td style="text-align: left">36&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">2&lt;/td>
&lt;td style="text-align: left">3&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">10&lt;/td>
&lt;td style="text-align: left">2018-01-11&lt;/td>
&lt;td style="text-align: left">51&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">2&lt;/td>
&lt;td style="text-align: left">4&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">11&lt;/td>
&lt;td style="text-align: left">2018-01-12&lt;/td>
&lt;td style="text-align: left">60&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">2&lt;/td>
&lt;td style="text-align: left">5&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">12&lt;/td>
&lt;td style="text-align: left">2018-01-13&lt;/td>
&lt;td style="text-align: left">61&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">2&lt;/td>
&lt;td style="text-align: left">6&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">13&lt;/td>
&lt;td style="text-align: left">2018-01-14&lt;/td>
&lt;td style="text-align: left">23&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">3&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">14&lt;/td>
&lt;td style="text-align: left">2018-01-15&lt;/td>
&lt;td style="text-align: left">21&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">3&lt;/td>
&lt;td style="text-align: left">2&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">15&lt;/td>
&lt;td style="text-align: left">2018-01-16&lt;/td>
&lt;td style="text-align: left">33&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">4&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">16&lt;/td>
&lt;td style="text-align: left">2018-01-17&lt;/td>
&lt;td style="text-align: left">34&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">4&lt;/td>
&lt;td style="text-align: left">2&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">17&lt;/td>
&lt;td style="text-align: left">2018-01-18&lt;/td>
&lt;td style="text-align: left">32&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">5&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">18&lt;/td>
&lt;td style="text-align: left">2018-01-19&lt;/td>
&lt;td style="text-align: left">34&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">6&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">19&lt;/td>
&lt;td style="text-align: left">2018-01-20&lt;/td>
&lt;td style="text-align: left">47&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">6&lt;/td>
&lt;td style="text-align: left">2&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">20&lt;/td>
&lt;td style="text-align: left">2018-01-21&lt;/td>
&lt;td style="text-align: left">49&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">6&lt;/td>
&lt;td style="text-align: left">3&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">21&lt;/td>
&lt;td style="text-align: left">2018-01-22&lt;/td>
&lt;td style="text-align: left">39&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">6&lt;/td>
&lt;td style="text-align: left">4&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">22&lt;/td>
&lt;td style="text-align: left">2018-01-23&lt;/td>
&lt;td style="text-align: left">55&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">6&lt;/td>
&lt;td style="text-align: left">5&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">23&lt;/td>
&lt;td style="text-align: left">2018-01-24&lt;/td>
&lt;td style="text-align: left">42&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">6&lt;/td>
&lt;td style="text-align: left">6&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">24&lt;/td>
&lt;td style="text-align: left">2018-01-25&lt;/td>
&lt;td style="text-align: left">30&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">7&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">25&lt;/td>
&lt;td style="text-align: left">2018-01-26&lt;/td>
&lt;td style="text-align: left">34&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">8&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">26&lt;/td>
&lt;td style="text-align: left">2018-01-27&lt;/td>
&lt;td style="text-align: left">53&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">8&lt;/td>
&lt;td style="text-align: left">2&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">27&lt;/td>
&lt;td style="text-align: left">2018-01-28&lt;/td>
&lt;td style="text-align: left">52&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">8&lt;/td>
&lt;td style="text-align: left">3&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">28&lt;/td>
&lt;td style="text-align: left">2018-01-29&lt;/td>
&lt;td style="text-align: left">43&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">8&lt;/td>
&lt;td style="text-align: left">4&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">29&lt;/td>
&lt;td style="text-align: left">2018-01-30&lt;/td>
&lt;td style="text-align: left">31&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">9&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">30&lt;/td>
&lt;td style="text-align: left">2018-01-31&lt;/td>
&lt;td style="text-align: left">30&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">9&lt;/td>
&lt;td style="text-align: left">2&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3 id="step-5">Step 5&lt;/h3>
&lt;!-- raw HTML omitted -->
&lt;p>Looking at the results of the previous step, we can see the simply asking for &lt;code>df['step5'].max()&lt;/code> would give us the longest sequence of days for which the value of &lt;code>freezing&lt;/code> remained constant. How do we limit that to only consider sequences in which &lt;code>freezing&lt;/code> is &lt;code>True&lt;/code>? We again take advantage of the fact that a boolean is just an integer, and we multiply the result of the previous step by the value of the &lt;code>freezing&lt;/code> series:&lt;/p>
&lt;pre tabindex="0">&lt;code>df[&amp;#39;step5&amp;#39;] = df[&amp;#39;freezing&amp;#39;] * df[&amp;#39;step4&amp;#39;]
&lt;/code>&lt;/pre>&lt;p>This will zero out all the values from the previous step in which &lt;code>freezing&lt;/code> is &lt;code>False&lt;/code>, because &lt;code>False * x&lt;/code> is the same as &lt;code>0 * x&lt;/code>. This gives us our final result:&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align: left">&lt;/th>
&lt;th style="text-align: left">DATE&lt;/th>
&lt;th style="text-align: left">TMAX&lt;/th>
&lt;th style="text-align: left">freezing&lt;/th>
&lt;th style="text-align: left">step2&lt;/th>
&lt;th style="text-align: left">step3&lt;/th>
&lt;th style="text-align: left">step4&lt;/th>
&lt;th style="text-align: left">step5&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align: left">0&lt;/td>
&lt;td style="text-align: left">2018-01-01&lt;/td>
&lt;td style="text-align: left">13&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">1&lt;/td>
&lt;td style="text-align: left">2018-01-02&lt;/td>
&lt;td style="text-align: left">19&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;td style="text-align: left">2&lt;/td>
&lt;td style="text-align: left">2&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">2&lt;/td>
&lt;td style="text-align: left">2018-01-03&lt;/td>
&lt;td style="text-align: left">29&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;td style="text-align: left">3&lt;/td>
&lt;td style="text-align: left">3&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">3&lt;/td>
&lt;td style="text-align: left">2018-01-04&lt;/td>
&lt;td style="text-align: left">30&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;td style="text-align: left">4&lt;/td>
&lt;td style="text-align: left">4&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">4&lt;/td>
&lt;td style="text-align: left">2018-01-05&lt;/td>
&lt;td style="text-align: left">24&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;td style="text-align: left">5&lt;/td>
&lt;td style="text-align: left">5&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">5&lt;/td>
&lt;td style="text-align: left">2018-01-06&lt;/td>
&lt;td style="text-align: left">12&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;td style="text-align: left">6&lt;/td>
&lt;td style="text-align: left">6&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">6&lt;/td>
&lt;td style="text-align: left">2018-01-07&lt;/td>
&lt;td style="text-align: left">17&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;td style="text-align: left">7&lt;/td>
&lt;td style="text-align: left">7&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">7&lt;/td>
&lt;td style="text-align: left">2018-01-08&lt;/td>
&lt;td style="text-align: left">35&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">2&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;td style="text-align: left">0&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">8&lt;/td>
&lt;td style="text-align: left">2018-01-09&lt;/td>
&lt;td style="text-align: left">43&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">2&lt;/td>
&lt;td style="text-align: left">2&lt;/td>
&lt;td style="text-align: left">0&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">9&lt;/td>
&lt;td style="text-align: left">2018-01-10&lt;/td>
&lt;td style="text-align: left">36&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">2&lt;/td>
&lt;td style="text-align: left">3&lt;/td>
&lt;td style="text-align: left">0&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">10&lt;/td>
&lt;td style="text-align: left">2018-01-11&lt;/td>
&lt;td style="text-align: left">51&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">2&lt;/td>
&lt;td style="text-align: left">4&lt;/td>
&lt;td style="text-align: left">0&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">11&lt;/td>
&lt;td style="text-align: left">2018-01-12&lt;/td>
&lt;td style="text-align: left">60&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">2&lt;/td>
&lt;td style="text-align: left">5&lt;/td>
&lt;td style="text-align: left">0&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">12&lt;/td>
&lt;td style="text-align: left">2018-01-13&lt;/td>
&lt;td style="text-align: left">61&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">2&lt;/td>
&lt;td style="text-align: left">6&lt;/td>
&lt;td style="text-align: left">0&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">13&lt;/td>
&lt;td style="text-align: left">2018-01-14&lt;/td>
&lt;td style="text-align: left">23&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">3&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">14&lt;/td>
&lt;td style="text-align: left">2018-01-15&lt;/td>
&lt;td style="text-align: left">21&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">3&lt;/td>
&lt;td style="text-align: left">2&lt;/td>
&lt;td style="text-align: left">2&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">15&lt;/td>
&lt;td style="text-align: left">2018-01-16&lt;/td>
&lt;td style="text-align: left">33&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">4&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;td style="text-align: left">0&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">16&lt;/td>
&lt;td style="text-align: left">2018-01-17&lt;/td>
&lt;td style="text-align: left">34&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">4&lt;/td>
&lt;td style="text-align: left">2&lt;/td>
&lt;td style="text-align: left">0&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">17&lt;/td>
&lt;td style="text-align: left">2018-01-18&lt;/td>
&lt;td style="text-align: left">32&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">5&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">18&lt;/td>
&lt;td style="text-align: left">2018-01-19&lt;/td>
&lt;td style="text-align: left">34&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">6&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;td style="text-align: left">0&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">19&lt;/td>
&lt;td style="text-align: left">2018-01-20&lt;/td>
&lt;td style="text-align: left">47&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">6&lt;/td>
&lt;td style="text-align: left">2&lt;/td>
&lt;td style="text-align: left">0&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">20&lt;/td>
&lt;td style="text-align: left">2018-01-21&lt;/td>
&lt;td style="text-align: left">49&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">6&lt;/td>
&lt;td style="text-align: left">3&lt;/td>
&lt;td style="text-align: left">0&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">21&lt;/td>
&lt;td style="text-align: left">2018-01-22&lt;/td>
&lt;td style="text-align: left">39&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">6&lt;/td>
&lt;td style="text-align: left">4&lt;/td>
&lt;td style="text-align: left">0&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">22&lt;/td>
&lt;td style="text-align: left">2018-01-23&lt;/td>
&lt;td style="text-align: left">55&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">6&lt;/td>
&lt;td style="text-align: left">5&lt;/td>
&lt;td style="text-align: left">0&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">23&lt;/td>
&lt;td style="text-align: left">2018-01-24&lt;/td>
&lt;td style="text-align: left">42&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">6&lt;/td>
&lt;td style="text-align: left">6&lt;/td>
&lt;td style="text-align: left">0&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">24&lt;/td>
&lt;td style="text-align: left">2018-01-25&lt;/td>
&lt;td style="text-align: left">30&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">7&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">25&lt;/td>
&lt;td style="text-align: left">2018-01-26&lt;/td>
&lt;td style="text-align: left">34&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">8&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;td style="text-align: left">0&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">26&lt;/td>
&lt;td style="text-align: left">2018-01-27&lt;/td>
&lt;td style="text-align: left">53&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">8&lt;/td>
&lt;td style="text-align: left">2&lt;/td>
&lt;td style="text-align: left">0&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">27&lt;/td>
&lt;td style="text-align: left">2018-01-28&lt;/td>
&lt;td style="text-align: left">52&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">8&lt;/td>
&lt;td style="text-align: left">3&lt;/td>
&lt;td style="text-align: left">0&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">28&lt;/td>
&lt;td style="text-align: left">2018-01-29&lt;/td>
&lt;td style="text-align: left">43&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">8&lt;/td>
&lt;td style="text-align: left">4&lt;/td>
&lt;td style="text-align: left">0&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">29&lt;/td>
&lt;td style="text-align: left">2018-01-30&lt;/td>
&lt;td style="text-align: left">31&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">9&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">30&lt;/td>
&lt;td style="text-align: left">2018-01-31&lt;/td>
&lt;td style="text-align: left">30&lt;/td>
&lt;td style="text-align: left">True&lt;/td>
&lt;td style="text-align: left">False&lt;/td>
&lt;td style="text-align: left">9&lt;/td>
&lt;td style="text-align: left">2&lt;/td>
&lt;td style="text-align: left">2&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3 id="step-6">Step 6&lt;/h3>
&lt;p>Now the answer to our question is as simple as asking for the maximum value from the previous step:&lt;/p>
&lt;pre tabindex="0">&lt;code>max_consecutive_dbf = df[&amp;#39;step5&amp;#39;].max()
&lt;/code>&lt;/pre>&lt;p>And if everything worked as expected, we should find that the longest consecutive sequence of days on which the temperature stayed below freezing was 7 days, from 2018-01-01 through 2018-01-07:&lt;/p>
&lt;pre tabindex="0">&lt;code>assert max_consecutive_dbf == 7
&lt;/code>&lt;/pre>&lt;h2 id="results">Results&lt;/h2>
&lt;p>If we look at the results for the past 20 years, we see the following:&lt;/p>
&lt;figure class="left" >
&lt;img src="sample-results.png" />
&lt;/figure>
&lt;p>For data used in the above chart, the average stretch in which the temperature stays below freezing is 6.45 days (the average for the entire dataset is 6.33 days).&lt;/p></content></item></channel></rss>