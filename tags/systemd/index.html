<!doctype html><html lang=en><head><title>Systemd :: blog.oddbit.com</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://blog.oddbit.com/tags/systemd/><script async src="https://www.googletagmanager.com/gtag/js?id=G-G1FYT93ENG"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-G1FYT93ENG")}</script><link rel=stylesheet href=https://blog.oddbit.com/css/buttons.min.86f6b4c106b6c6eb690ae5203d36b442c1f66f718ff4e8164fa86cf6c61ad641.css><link rel=stylesheet href=https://blog.oddbit.com/css/code.min.d529ea4b2fb8d34328d7d31afc5466d5f7bc2f0bc9abdd98b69385335d7baee4.css><link rel=stylesheet href=https://blog.oddbit.com/css/fonts.min.5bb7ed13e1d00d8ff39ea84af26737007eb5051b157b86fc24487c94f3dc8bbe.css><link rel=stylesheet href=https://blog.oddbit.com/css/footer.min.eb8dfc2c6a7eafa36cd3ba92d63e69e849e2200e0002a228d137f236b09ecd75.css><link rel=stylesheet href=https://blog.oddbit.com/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css><link rel=stylesheet href=https://blog.oddbit.com/css/header.min.75c7eb0e2872d95ff48109c6647d0223a38db52e2561dd87966eb5fc7c6bdac6.css><link rel=stylesheet href=https://blog.oddbit.com/css/main.min.36833afd348409fc6c3d09d0897c5833d9d5bf1ff31f5e60ea3ee42ce2b1268c.css><link rel=stylesheet href=https://blog.oddbit.com/css/menu.min.3c17467ebeb3d38663dce68f71f519901124fa5cbb4519b2fb0667a21e9aca39.css><link rel=stylesheet href=https://blog.oddbit.com/css/pagination.min.bbb986dbce00a5ce5aca0504b7925fc1c581992a4bf57f163e5d69cc1db7d836.css><link rel=stylesheet href=https://blog.oddbit.com/css/post.min.e6dddd258e64c83e05cec0cd49c05216742d42fc8ecbfbe6b67083412b609bd3.css><link rel=stylesheet href=https://blog.oddbit.com/css/syntax.min.a0773cce9310cb6d8ed23e50f005448facf29a53001b57e038828daa466b25c0.css><link rel=stylesheet href=https://blog.oddbit.com/css/terminal.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.css><link rel=stylesheet href=https://blog.oddbit.com/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css><link rel=stylesheet href=https://blog.oddbit.com/style.css><link rel="shortcut icon" href=https://blog.oddbit.com/favicon.png><link rel=apple-touch-icon href=https://blog.oddbit.com/apple-touch-icon.png><meta name=twitter:card content="summary"><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:title" content="Systemd"><meta property="og:description" content><meta property="og:url" content="https://blog.oddbit.com/tags/systemd/"><meta property="og:site_name" content="blog.oddbit.com"><meta property="og:image" content="https://blog.oddbit.com/og-image.png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><link href=/tags/systemd/rss.xml rel=alternate type=application/rss+xml title=blog.oddbit.com></head><body><div class="container center"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>the odd bit blog</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/>/</a></li><li><a href=https://oddbit.com>/about</a></li><li><a href=/posts>/posts</a></li><li><a href=/tags>/tags</a></li><li><a href=/archive>/archive</a></li><li><a href=/rss.xml>/feed</a></li><li><a href=https://github.com/larsks>→Github</a></li><li><a href=https://hachyderm.io/@larsks>→Mastodon</a></li><li><a href=https://twitter.com/larsks>→Twitter</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/>/</a></li><li><a href=https://oddbit.com>/about</a></li><li><a href=/posts>/posts</a></li><li><a href=/tags>/tags</a></li><li><a href=/archive>/archive</a></li><li><a href=/rss.xml>/feed</a></li><li><ul class=menu><li class=menu__trigger>&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=https://github.com/larsks>→Github</a></li><li><a href=https://hachyderm.io/@larsks>→Mastodon</a></li><li><a href=https://twitter.com/larsks>→Twitter</a></li></ul></li></ul></li></ul></nav></header><div class=content><h1>Posts for: #Systemd</h1><div class=posts><article class="post on-list"><h1 class=post-title><a href=https://blog.oddbit.com/post/2016-02-08-a-systemd-nspawn-connection-dr/>A systemd-nspawn connection driver for Ansible</a></h1><div class=post-meta><time class=post-date>2016-02-08</time></div><span class=post-tags>#<a href=https://blog.oddbit.com/tags/ansible/>ansible</a>&nbsp;
#<a href=https://blog.oddbit.com/tags/systemd/>systemd</a>&nbsp;
#<a href=https://blog.oddbit.com/tags/pull-request/>pull-request</a>&nbsp;</span><div class=post-content><p>I wrote <a href=https://blog.oddbit.com/post/2016-02-07-systemd-nspawn-for-fun-and-wel/>earlier</a> about <a href=https://www.freedesktop.org/software/systemd/man/systemd-nspawn.html>systemd-nspawn</a>, and how it can take much
of the fiddly work out of setting up functional <code>chroot</code> environments.
I&rsquo;m a regular <a href=http://ansible.com/>Ansible</a> user, and I wanted to be able to apply some
of those techniques to my playbooks.</p><p>Ansible already has a <code>chroot</code> module, of course, but for some
situations &ndash; such as targeting an emulated <code>chroot</code> environment &ndash;
that just means a lot of extra work. Using <code>systemd-nspawn</code> makes
this trivial.</p></div><div><a class="read-more button inline" href=/post/2016-02-08-a-systemd-nspawn-connection-dr/>[read more]</a></div></article><article class="post on-list"><h1 class=post-title><a href=https://blog.oddbit.com/post/2016-02-07-systemd-nspawn-for-fun-and-wel/>Systemd-nspawn for fun and&mldr;well, mostly for fun</a></h1><div class=post-meta><time class=post-date>2016-02-07</time></div><span class=post-tags>#<a href=https://blog.oddbit.com/tags/systemd/>systemd</a>&nbsp;
#<a href=https://blog.oddbit.com/tags/containers/>containers</a>&nbsp;
#<a href=https://blog.oddbit.com/tags/qemu/>qemu</a>&nbsp;
#<a href=https://blog.oddbit.com/tags/raspberrypi/>raspberrypi</a>&nbsp;</span><div class=post-content><p><code>systemd-nspawn</code> has been called <a href=https://wiki.archlinux.org/index.php/Systemd-nspawn>&ldquo;chroot on steroids&rdquo;</a>,
but if you think of it as <a href=http://docker.com>Docker</a> with a slightly different target
you wouldn&rsquo;t be far wrong, either. It can be used to spawn containers
on your host, and has a variety of options for configuring the
containerized environment through the use of private networking, bind
mounts, capability controls, and a variety of other facilities that
give you flexible container management.</p><p>There are many different ways in which it can be used. I&rsquo;m going to
focus on one that&rsquo;s a bit of a corner use case that I find
particularly interesting. In this article we&rsquo;re going to explore how
we can use <a href=https://www.freedesktop.org/software/systemd/man/systemd-nspawn.html>systemd-nspawn</a> to spawn lightweight containers for
architectures other than that of our host system.</p></div><div><a class="read-more button inline" href=/post/2016-02-07-systemd-nspawn-for-fun-and-wel/>[read more]</a></div></article><article class="post on-list"><h1 class=post-title><a href=https://blog.oddbit.com/post/2015-01-18-docker-vs-privatetmp/>Docker vs. PrivateTmp</a></h1><div class=post-meta><time class=post-date>2015-01-18</time></div><span class=post-tags>#<a href=https://blog.oddbit.com/tags/docker/>docker</a>&nbsp;
#<a href=https://blog.oddbit.com/tags/systemd/>systemd</a>&nbsp;
#<a href=https://blog.oddbit.com/tags/namespaces/>namespaces</a>&nbsp;</span><div class=post-content><p>While working with Docker <a href=https://blog.oddbit.com/post/2015-01-17-running-novalibvirt-and-novado/>the other day</a>, I ran into an
undesirable interaction between Docker and <a href=http://www.freedesktop.org/wiki/Software/systemd/>systemd</a> services that
utilize the <code>PrivateTmp</code> directive.</p><p>The <a href="http://www.freedesktop.org/software/systemd/man/systemd.exec.html#PrivateTmp=">PrivateTmp</a> directive, if <code>true</code>, &ldquo;sets up a new file system
namespace for the executed processes and mounts private <code>/tmp</code> and
<code>/var/tmp</code> directories inside it that is not shared by processes outside
of the namespace&rdquo;. This is a great idea from a <a href=https://danwalsh.livejournal.com/51459.html>security
perspective</a>, but can cause some unanticipated consequences.</p><h2 id=the-problem-in-a-nutshell>The problem in a nutshell</h2><ol><li><p>Start a Docker container:</p></div><div><a class="read-more button inline" href=/post/2015-01-18-docker-vs-privatetmp/>[read more]</a></div></article><article class="post on-list"><h1 class=post-title><a href=https://blog.oddbit.com/post/2014-12-02-starting-systemd-services-with/>Starting systemd services without blocking</a></h1><div class=post-meta><time class=post-date>2014-12-02</time></div><span class=post-tags>#<a href=https://blog.oddbit.com/tags/systemd/>systemd</a>&nbsp;</span><div class=post-content><p>Recently, I&rsquo;ve been playing around with <a href=https://blog.oddbit.com/post/2014-11-24-fedora-atomic-openstack-and-ku/>Fedora Atomic and
Kubernetes</a>. I ran into a frustrating problem in which I
would attempt to start a service from within a script launched by
<a href=http://cloudinit.readthedocs.org/>cloud-init</a>, only to have have <code>systemctl</code> block indefinitely
because the service I was attempting to start was dependent on
<code>cloud-init</code> finishing first.</p><p>It turns out that <code>systemctl</code> has a flag meant exactly for this
situation:</p><pre><code>   --no-block
       Do not synchronously wait for the requested operation to finish. If
       this is not specified, the job will be verified, enqueued and
       systemctl will wait until it is completed. By passing this
       argument, it is only verified and enqueued.
</code></pre><p>Replacing <code>systemctl start &lt;service></code> with <code>systemctl start --no-block &lt;service></code> has solved that particular problem.</p></div><div><a class="read-more button inline" href=/post/2014-12-02-starting-systemd-services-with/>[read more]</a></div></article><article class="post on-list"><h1 class=post-title><a href=https://blog.oddbit.com/post/2012-11-05-fedora-private-tmp/>Private /tmp directories in Fedora</a></h1><div class=post-meta><time class=post-date>2012-11-05</time></div><span class=post-tags>#<a href=https://blog.oddbit.com/tags/fedora/>fedora</a>&nbsp;
#<a href=https://blog.oddbit.com/tags/systemd/>systemd</a>&nbsp;</span><div class=post-content><p>I ran into an odd problem the other day: I was testing out some
configuration changes for a web application by dropping files into
<code>/tmp</code> and pointing the application configuration at the appropriate
directory. Everything worked out great when testing it by hand&mldr;but
when starting up the <code>httpd</code> service, the application behaved as if it
was unable to find any of the files in <code>/tmp</code>.</p><p>My first assumption was that had simply missed something obvious like
file permissions or that I had a typo in my configuration, but after
repeated checks and lots of testing it was obvious that something else
was going on.</p></div><div><a class="read-more button inline" href=/post/2012-11-05-fedora-private-tmp/>[read more]</a></div></article><div class=pagination><div class=pagination__buttons></div></div></div></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user"><span>Lars Kellogg-Stedman</span>
<span>:: <a href=https://github.com/panr/hugo-theme-terminal target=_blank>Theme</a> made by <a href=https://github.com/panr target=_blank>panr</a></span></div></div></footer><script type=text/javascript src=/bundle.min.js></script><script src=/js/mermaid.min.js></script><script>mermaid.initialize({startOnLoad:!0})</script></div></body></html>