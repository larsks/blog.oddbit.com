<!doctype html><html lang=en><head><title>:: blog.oddbit.com</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://blog.oddbit.com/posts/><script async src="https://www.googletagmanager.com/gtag/js?id=G-G1FYT93ENG"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-G1FYT93ENG")}</script><link rel=stylesheet href=https://blog.oddbit.com/css/buttons.min.86f6b4c106b6c6eb690ae5203d36b442c1f66f718ff4e8164fa86cf6c61ad641.css><link rel=stylesheet href=https://blog.oddbit.com/css/code.min.d529ea4b2fb8d34328d7d31afc5466d5f7bc2f0bc9abdd98b69385335d7baee4.css><link rel=stylesheet href=https://blog.oddbit.com/css/fonts.min.5bb7ed13e1d00d8ff39ea84af26737007eb5051b157b86fc24487c94f3dc8bbe.css><link rel=stylesheet href=https://blog.oddbit.com/css/footer.min.eb8dfc2c6a7eafa36cd3ba92d63e69e849e2200e0002a228d137f236b09ecd75.css><link rel=stylesheet href=https://blog.oddbit.com/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css><link rel=stylesheet href=https://blog.oddbit.com/css/header.min.75c7eb0e2872d95ff48109c6647d0223a38db52e2561dd87966eb5fc7c6bdac6.css><link rel=stylesheet href=https://blog.oddbit.com/css/main.min.36833afd348409fc6c3d09d0897c5833d9d5bf1ff31f5e60ea3ee42ce2b1268c.css><link rel=stylesheet href=https://blog.oddbit.com/css/menu.min.3c17467ebeb3d38663dce68f71f519901124fa5cbb4519b2fb0667a21e9aca39.css><link rel=stylesheet href=https://blog.oddbit.com/css/pagination.min.bbb986dbce00a5ce5aca0504b7925fc1c581992a4bf57f163e5d69cc1db7d836.css><link rel=stylesheet href=https://blog.oddbit.com/css/post.min.e6dddd258e64c83e05cec0cd49c05216742d42fc8ecbfbe6b67083412b609bd3.css><link rel=stylesheet href=https://blog.oddbit.com/css/syntax.min.a0773cce9310cb6d8ed23e50f005448facf29a53001b57e038828daa466b25c0.css><link rel=stylesheet href=https://blog.oddbit.com/css/terminal.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.css><link rel=stylesheet href=https://blog.oddbit.com/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css><link rel=stylesheet href=https://blog.oddbit.com/style.css><link rel="shortcut icon" href=https://blog.oddbit.com/favicon.png><link rel=apple-touch-icon href=https://blog.oddbit.com/apple-touch-icon.png><meta name=twitter:card content="summary"><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:title" content><meta property="og:description" content><meta property="og:url" content="https://blog.oddbit.com/posts/"><meta property="og:site_name" content="blog.oddbit.com"><meta property="og:image" content="https://blog.oddbit.com/og-image.png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><link href=/posts/rss.xml rel=alternate type=application/rss+xml title=blog.oddbit.com></head><body><div class="container center"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>the odd bit blog</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/>/</a></li><li><a href=https://oddbit.com>/about</a></li><li><a href=/posts>/posts</a></li><li><a href=/tags>/tags</a></li><li><a href=/archive>/archive</a></li><li><a href=/rss.xml>/feed</a></li><li><a href=https://github.com/larsks>→Github</a></li><li><a href=https://hachyderm.io/@larsks>→Mastodon</a></li><li><a href=https://twitter.com/larsks>→Twitter</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/>/</a></li><li><a href=https://oddbit.com>/about</a></li><li><a href=/posts>/posts</a></li><li><a href=/tags>/tags</a></li><li><a href=/archive>/archive</a></li><li><a href=/rss.xml>/feed</a></li><li><ul class=menu><li class=menu__trigger>&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=https://github.com/larsks>→Github</a></li><li><a href=https://hachyderm.io/@larsks>→Mastodon</a></li><li><a href=https://twitter.com/larsks>→Twitter</a></li></ul></li></ul></li></ul></nav></header><div class=content><div class=posts><article class="post on-list"><h2 class=post-title><a href=https://blog.oddbit.com/post/2014-12-22-accessing-the-serial-console-o/>Accessing the serial console of your Nova servers</a></h2><div class=post-meta><time class=post-date>2014-12-22</time></div><span class=post-tags>#<a href=https://blog.oddbit.com/tags/openstack/>openstack</a>&nbsp;
#<a href=https://blog.oddbit.com/tags/nova/>nova</a>&nbsp;</span><div class=post-content><p>One of the new features available in the Juno release of OpenStack is
support for <a href=https://blueprints.launchpad.net/nova/+spec/serial-ports>serial console access to your Nova
servers</a>. This post looks into how to configure the
serial console feature and then how to access the serial consoles of
your Nova servers.</p><h2 id=configuring-serial-console-support>Configuring serial console support</h2><p>In previous release of OpenStack, read-only access to the serial
console of your servers was available through the
<code>os-getConsoleOutput</code> server action (exposed via <code>nova console-log</code> on
the command line). Most cloud-specific Linux images are configured
with a command line that includes something like <code>console=tty0 console=ttyS0,115200n81</code>, which ensures that kernel output and other
messages are available on the serial console. This is a useful
mechanism for diagnosing problems in the event that you do not have
network access to a server.</p></div><div><a class="read-more button inline" href=/post/2014-12-22-accessing-the-serial-console-o/>[read more]</a></div></article><article class="post on-list"><h2 class=post-title><a href=https://blog.oddbit.com/post/2014-12-10-cloudinit-and-the-case-of-the-/>Cloud-init and the case of the changing hostname</a></h2><div class=post-meta><time class=post-date>2014-12-10</time></div><span class=post-tags>#<a href=https://blog.oddbit.com/tags/openstack/>openstack</a>&nbsp;
#<a href=https://blog.oddbit.com/tags/rdo/>rdo</a>&nbsp;
#<a href=https://blog.oddbit.com/tags/neutron/>neutron</a>&nbsp;</span><div class=post-content><h2 id=setting-the-stage>Setting the stage</h2><p>I ran into a problem earlier this week deploying RDO Icehouse under
RHEL 6. My target systems were a set of libvirt guests deployed from
the RHEL 6 KVM guest image, which includes <a href=https://cloudinit.readthedocs.org/en/latest/>cloud-init</a> in order to
support automatic configuration in cloud environments. I take
advantage of this when using <code>libvirt</code> by attaching a configuration
drive so that I can pass in ssh keys and a <code>user-data</code> script.</p></div><div><a class="read-more button inline" href=/post/2014-12-10-cloudinit-and-the-case-of-the-/>[read more]</a></div></article><article class="post on-list"><h2 class=post-title><a href=https://blog.oddbit.com/post/2014-12-02-starting-systemd-services-with/>Starting systemd services without blocking</a></h2><div class=post-meta><time class=post-date>2014-12-02</time></div><span class=post-tags>#<a href=https://blog.oddbit.com/tags/systemd/>systemd</a>&nbsp;</span><div class=post-content><p>Recently, I&rsquo;ve been playing around with <a href=https://blog.oddbit.com/post/2014-11-24-fedora-atomic-openstack-and-ku/>Fedora Atomic and
Kubernetes</a>. I ran into a frustrating problem in which I
would attempt to start a service from within a script launched by
<a href=http://cloudinit.readthedocs.org/>cloud-init</a>, only to have have <code>systemctl</code> block indefinitely
because the service I was attempting to start was dependent on
<code>cloud-init</code> finishing first.</p><p>It turns out that <code>systemctl</code> has a flag meant exactly for this
situation:</p><pre><code>   --no-block
       Do not synchronously wait for the requested operation to finish. If
       this is not specified, the job will be verified, enqueued and
       systemctl will wait until it is completed. By passing this
       argument, it is only verified and enqueued.
</code></pre><p>Replacing <code>systemctl start &lt;service></code> with <code>systemctl start --no-block &lt;service></code> has solved that particular problem.</p></div><div><a class="read-more button inline" href=/post/2014-12-02-starting-systemd-services-with/>[read more]</a></div></article><article class="post on-list"><h2 class=post-title><a href=https://blog.oddbit.com/post/2014-11-24-fedora-atomic-openstack-and-ku/>Fedora Atomic, OpenStack, and Kubernetes (oh my)</a></h2><div class=post-meta><time class=post-date>2014-11-24</time></div><span class=post-tags>#<a href=https://blog.oddbit.com/tags/openstack/>openstack</a>&nbsp;
#<a href=https://blog.oddbit.com/tags/kubernetes/>kubernetes</a>&nbsp;
#<a href=https://blog.oddbit.com/tags/fedora/>fedora</a>&nbsp;
#<a href=https://blog.oddbit.com/tags/atomic/>atomic</a>&nbsp;</span><div class=post-content><p>While experimenting with <a href=http://www.projectatomic.io/>Fedora Atomic</a>, I was looking for an
elegant way to automatically deploy Atomic into an <a href=http://openstack.org/>OpenStack</a>
environment and then automatically schedule some <a href=http://docker.com/>Docker</a> containers
on the Atomic host. This post describes my solution.</p><p>Like many other cloud-targeted distributions, Fedora Atomic runs
<a href=http://cloudinit.readthedocs.org/>cloud-init</a> when the system boots. We can take advantage of this
to configure the system at first boot by providing a <code>user-data</code> blob
to Nova when we boot the instance. A <code>user-data</code> blob can be as
simple as a shell script, and while we could arguably mash everything
into a single script it wouldn&rsquo;t be particularly maintainable or
flexible in the face of different pod/service/etc descriptions.</p></div><div><a class="read-more button inline" href=/post/2014-11-24-fedora-atomic-openstack-and-ku/>[read more]</a></div></article><article class="post on-list"><h2 class=post-title><a href=https://blog.oddbit.com/post/2014-11-15-creating-a-windows-image-for-o/>Creating a Windows image for OpenStack</a></h2><div class=post-meta><time class=post-date>2014-11-15</time></div><span class=post-tags>#<a href=https://blog.oddbit.com/tags/openstack/>openstack</a>&nbsp;
#<a href=https://blog.oddbit.com/tags/windows/>windows</a>&nbsp;</span><div class=post-content><p>If you want to build a Windows image for use in your OpenStack
environment, you can follow <a href=http://docs.openstack.org/image-guide/content/windows-image.html>the example in the official
documentation</a>, or you can grab a Windows 2012r2
evaluation <a href=http://www.cloudbase.it/ws2012r2/>pre-built image</a> from the nice folks at <a href=http://www.cloudbase.it/>CloudBase</a>.</p><p>The CloudBase-provided image is built using a set of scripts and
configuration files that CloudBase has <a href=https://github.com/cloudbase/windows-openstack-imaging-tools/>made available on
GitHub</a>.</p><p>The CloudBase repository is an excellent source of information, but I
wanted to understand the process myself. This post describes the
process I went through to establish an automated process for
generating a Windows image suitable for use with OpenStack.</p></div><div><a class="read-more button inline" href=/post/2014-11-15-creating-a-windows-image-for-o/>[read more]</a></div></article><article class="post on-list"><h2 class=post-title><a href=https://blog.oddbit.com/post/2014-10-22-building-docker-images-with-pu/>Building Docker images with Puppet</a></h2><div class=post-meta><time class=post-date>2014-10-22</time></div><span class=post-tags>#<a href=https://blog.oddbit.com/tags/puppet/>puppet</a>&nbsp;
#<a href=https://blog.oddbit.com/tags/docker/>docker</a>&nbsp;</span><div class=post-content><p>I like <a href=http://docker.com/>Docker</a>, but I&rsquo;m not a huge fan of using shell scripts for
complex system configuration&mldr;and Dockerfiles are basically giant
shell scripts.</p><p>I was curious whether or not it would be possible to use Puppet during
the <code>docker build</code> process. As a test case, I used the
<a href=https://github.com/saz/puppet-ssh>ssh</a> module included in the openstack-puppet-modules package.</p><p>I started with a manifest like this (in <code>puppet/node.pp</code>):</p><pre><code>class { 'ssh': }
</code></pre><p>And a Dockerfile like this:</p></div><div><a class="read-more button inline" href=/post/2014-10-22-building-docker-images-with-pu/>[read more]</a></div></article><article class="post on-list"><h2 class=post-title><a href=https://blog.oddbit.com/post/2014-10-06-docker-networking-with-dedicat/>Docker networking with dedicated network containers</a></h2><div class=post-meta><time class=post-date>2014-10-06</time></div><span class=post-tags>#<a href=https://blog.oddbit.com/tags/docker/>docker</a>&nbsp;
#<a href=https://blog.oddbit.com/tags/networking/>networking</a>&nbsp;
#<a href=https://blog.oddbit.com/tags/kubernetes/>kubernetes</a>&nbsp;</span><div class=post-content><p>The current version of Docker has a very limited set of networking
options:</p><ul><li><code>bridge</code> &ndash; connect a container to the Docker bridge</li><li><code>host</code> &ndash; run the container in the global network namespace</li><li><code>container:xxx</code> &ndash; connect a container to the network namespace of
another container</li><li><code>none</code> &ndash; do not configure any networking</li></ul><p>If you need something more than that, you can use a tool like
<a href=https://github.com/jpetazzo/pipework>pipework</a> to provision additional network interfaces inside the
container, but this leads to a synchronization problem: <code>pipework</code> can
only be used after your container is running. This means that when
starting your container, you must have logic that will wait until the
necessary networking is available before starting your service.</p></div><div><a class="read-more button inline" href=/post/2014-10-06-docker-networking-with-dedicat/>[read more]</a></div></article><article class="post on-list"><h2 class=post-title><a href=https://blog.oddbit.com/post/2014-09-27-integrating-custom-code-with-n/>Integrating custom code with Nova using hooks</a></h2><div class=post-meta><time class=post-date>2014-09-27</time></div><span class=post-tags>#<a href=https://blog.oddbit.com/tags/openstack/>openstack</a>&nbsp;
#<a href=https://blog.oddbit.com/tags/nova/>nova</a>&nbsp;</span><div class=post-content><p>Would you like to run some custom Python code when Nova creates and
destroys virtual instances on your compute hosts? This is possible
using Nova&rsquo;s support for <a href=http://docs.openstack.org/developer/nova/devref/hooks.html>hooks</a>, but the existing documentation is
somewhat short on examples, so I&rsquo;ve spent some time trying to get
things working.</p><p>The <a href=https://github.com/larsks/demo_nova_hooks>demo_nova_hooks</a> repository contains a working example of the
techniques discussed in this article.</p><h2 id=whats-a-hook>What&rsquo;s a hook?</h2><p>A Nova &ldquo;hook&rdquo; is a mechanism that allows you to attach a class of your
own design to a particular function or method call in Nova. Your
class should define a <code>pre</code> method (that will be called before the
method is called) and <code>post</code> function (that will be called after the
method is called):</p></div><div><a class="read-more button inline" href=/post/2014-09-27-integrating-custom-code-with-n/>[read more]</a></div></article><article class="post on-list"><h2 class=post-title><a href=https://blog.oddbit.com/post/2014-09-23-stupid-cli-quickly-share-scree/>Stupid command line tricks: Quickly share screen captures</a></h2><div class=post-meta><time class=post-date>2014-09-23</time></div><span class=post-tags>#<a href=https://blog.oddbit.com/tags/cli/>cli</a>&nbsp;</span><div class=post-content><p>Sometimes you want to quickly share a screenshot with someone. Here&rsquo;s
my favorite mechanism, which assumes you have installed both <code>curl</code>
and the <a href=http://www.imagemagick.org/>ImageMagick</a> suite.</p><pre><code>$ import png:- | curl -T- -s chunk.io
http://chunk.io/f/76ea98ea081748e19de4507fde3c2c65  
</code></pre><p>When you run this command, you cursor will change into crosshairs.
Click on a window, and this will grab a png image of that window and
send it to <a href=http://chunk.io/>chunk.io</a> using curl.</p><p>You&rsquo;ll get back a URL that you can use to share the image with people.</p></div><div><a class="read-more button inline" href=/post/2014-09-23-stupid-cli-quickly-share-scree/>[read more]</a></div></article><article class="post on-list"><h2 class=post-title><a href=https://blog.oddbit.com/post/2014-09-05-heat-hangout/>Heat Hangout</a></h2><div class=post-meta><time class=post-date>2014-09-05</time></div><span class=post-tags>#<a href=https://blog.oddbit.com/tags/openstack/>openstack</a>&nbsp;
#<a href=https://blog.oddbit.com/tags/rdo/>rdo</a>&nbsp;
#<a href=https://blog.oddbit.com/tags/heat/>heat</a>&nbsp;</span><div class=post-content><p>I ran a Google Hangout this morning on <a href=https://plus.google.com/events/c9u4sjn7ksb8jrmma7vd25aok94>Deploying with Heat</a>. You
can find the slides for the presentation on line <a href=http://oddbit.com/rdo-hangout-heat-intro/#/>here</a>, and the
Heat templates (as well as slide sources) are available <a href=https://github.com/larsks/rdo-hangout-heat-intro/>on
github</a>.</p><p>If you have any questions about the presentation, please feel free to
ping me on irc (<code>larsks</code>).</p><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share; fullscreen" loading=eager referrerpolicy=strict-origin-when-cross-origin src="https://www.youtube.com/embed/qH-qYE1Kmpg?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 title="YouTube video"></iframe></div></div><div><a class="read-more button inline" href=/post/2014-09-05-heat-hangout/>[read more]</a></div></article><div class=pagination><div class=pagination__buttons><a href=/posts/page/12/ class="button inline prev">&lt; [<span class=button__text>Newer posts</span>]
</a>::
<a href=/posts/page/14/ class="button inline next">[<span class=button__text>Older posts</span>] ></a></div></div></div></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user"><span>Lars Kellogg-Stedman</span>
<span>:: <a href=https://github.com/panr/hugo-theme-terminal target=_blank>Theme</a> made by <a href=https://github.com/panr target=_blank>panr</a></span></div></div></footer><script type=text/javascript src=/bundle.min.js></script><script src=/js/mermaid.min.js></script><script>mermaid.initialize({startOnLoad:!0})</script></div></body></html>